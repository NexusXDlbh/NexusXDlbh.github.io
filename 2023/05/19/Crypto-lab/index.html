<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Crypto_lab | Meta Field</title><meta name="author" content="NexusLbh"><meta name="copyright" content="NexusLbh"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="密码学实验是要求文件读写明文、密钥和密文。 古典密码算法Caser加密  解密  分别创建明文文件text.txt、密文c.txt、密文解密后的文件m1.txt。 针对字符串加密，要考虑英文字母的大小写，a对应ASCII表十进制97，A对应十进制65，差值为32。 加密过程： 12345678910111213141516171819202122232425262728void encrypt(">
<meta property="og:type" content="article">
<meta property="og:title" content="Crypto_lab">
<meta property="og:url" content="http://nexuslbh.top/2023/05/19/Crypto-lab/index.html">
<meta property="og:site_name" content="Meta Field">
<meta property="og:description" content="密码学实验是要求文件读写明文、密钥和密文。 古典密码算法Caser加密  解密  分别创建明文文件text.txt、密文c.txt、密文解密后的文件m1.txt。 针对字符串加密，要考虑英文字母的大小写，a对应ASCII表十进制97，A对应十进制65，差值为32。 加密过程： 12345678910111213141516171819202122232425262728void encrypt(">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://nexuslbh.top/img/tree.png">
<meta property="article:published_time" content="2023-05-19T06:40:59.000Z">
<meta property="article:modified_time" content="2023-05-19T08:18:07.270Z">
<meta property="article:author" content="NexusLbh">
<meta property="article:tag" content="SEC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://nexuslbh.top/img/tree.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://nexuslbh.top/2023/05/19/Crypto-lab/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Crypto_lab',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-05-19 16:18:07'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/font.css"><meta name="generator" content="Hexo 5.4.2"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">67</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/tree.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Meta Field"><span class="site-name">Meta Field</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Crypto_lab</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-05-19T06:40:59.000Z" title="发表于 2023-05-19 14:40:59">2023-05-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-05-19T08:18:07.270Z" title="更新于 2023-05-19 16:18:07">2023-05-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Crypto_lab"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id><a href="#" class="headerlink" title=" "></a> </h2><p>密码学实验是要求文件读写明文、密钥和密文。</p>
<h2 id="古典密码算法"><a href="#古典密码算法" class="headerlink" title="古典密码算法"></a>古典密码算法</h2><h3 id="Caser"><a href="#Caser" class="headerlink" title="Caser"></a>Caser</h3><p>加密 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex" xmlns="http://www.w3.org/2000/svg" width="18.21ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 8049 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(710.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mo" transform="translate(1766.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2155.6,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(3255.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(4256,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"/></g><g data-mml-node="mo" transform="translate(4777,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mi" transform="translate(5166,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(6044,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/></g><g data-mml-node="mi" transform="translate(6529,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="mn" transform="translate(7049,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(500,0)"/></g></g></g></svg></mjx-container></p>
<p>解密 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex" xmlns="http://www.w3.org/2000/svg" width="18.21ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 8049 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(1155.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mo" transform="translate(2211.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(2600.6,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"/></g><g data-mml-node="mo" transform="translate(3255.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mi" transform="translate(4256,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"/></g><g data-mml-node="mo" transform="translate(4777,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mi" transform="translate(5166,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(6044,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/></g><g data-mml-node="mi" transform="translate(6529,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="mn" transform="translate(7049,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(500,0)"/></g></g></g></svg></mjx-container></p>
<p>分别创建明文文件<code>text.txt</code>、密文<code>c.txt</code>、密文解密后的文件<code>m1.txt</code>。</p>
<p>针对字符串加密，要考虑英文字母的大小写，<code>a</code>对应ASCII表十进制<strong>97</strong>，<code>A</code>对应十进制<strong>65</strong>，差值为<strong>32</strong>。</p>
<p>加密过程：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">char</span> c[],<span class="type">int</span> len,<span class="type">int</span> k,<span class="type">char</span> e[],FILE *fp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(c[i]&gt;=<span class="string">'a'</span>&amp;&amp;c[i]&lt;=<span class="string">'z'</span>-k)</span><br><span class="line">        {</span><br><span class="line">            e[i] = c[i] + k;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(c[i]&gt;=<span class="string">'a'</span>&amp;&amp;c[i]&gt;<span class="string">'z'</span>-k)</span><br><span class="line">        {</span><br><span class="line">            e[i] = c[i] + k - <span class="number">26</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(c[i]&gt;=<span class="string">'A'</span>&amp;&amp;c[i]&lt;=<span class="string">'Z'</span>-k)</span><br><span class="line">        {</span><br><span class="line">            e[i] = c[i] + k;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(c[i]&gt;=<span class="string">'A'</span>&amp;&amp;c[i]&gt;<span class="string">'Z'</span>-k)</span><br><span class="line">        {</span><br><span class="line">            e[i] = c[i] + k - <span class="number">26</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        {</span><br><span class="line">            e[i] = c[i];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">fputs</span>(e,fp);</span><br><span class="line">} </span><br></pre></td></tr></table></figure>
<p>解密过程：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">char</span> c[],<span class="type">int</span> len,<span class="type">int</span> k,<span class="type">char</span> d[],FILE *fp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(c[i]&gt;=<span class="string">'a'</span>+k&amp;&amp;c[i]&lt;=<span class="string">'z'</span>)</span><br><span class="line">        {</span><br><span class="line">            d[i] = c[i] - k;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(c[i]&gt;=<span class="string">'a'</span>&amp;&amp;c[i]&lt;<span class="string">'a'</span>+k)</span><br><span class="line">        {</span><br><span class="line">            d[i] = c[i] - k + <span class="number">26</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(c[i]&gt;=<span class="string">'A'</span>+k&amp;&amp;c[i]&lt;=<span class="string">'Z'</span>)</span><br><span class="line">        {</span><br><span class="line">            d[i] = c[i] - k;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(c[i]&gt;=<span class="string">'A'</span>&amp;&amp;c[i]&lt;<span class="string">'A'</span>+k)</span><br><span class="line">        {</span><br><span class="line">            d[i] = c[i] - k + <span class="number">26</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        {</span><br><span class="line">            d[i] = c[i];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">fputs</span>(d,fp);</span><br><span class="line">} </span><br></pre></td></tr></table></figure>
<p>main函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    FILE *fpr,*fpw;</span><br><span class="line">    <span class="type">int</span> m = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//do</span></span><br><span class="line">	<span class="comment">//{</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"加密输入:1.;解密输入2.\n"</span>);</span><br><span class="line">	    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line">	    <span class="keyword">if</span>(m!=<span class="number">1</span>&amp;&amp;m!=<span class="number">2</span>)</span><br><span class="line">	    	<span class="built_in">printf</span>(<span class="string">"Error\n"</span>);</span><br><span class="line">	    <span class="keyword">else</span></span><br><span class="line">	    {</span><br><span class="line">	    	<span class="type">int</span> len = <span class="number">0</span>,i = <span class="number">0</span>,k = <span class="number">0</span>;</span><br><span class="line">		    <span class="built_in">printf</span>(<span class="string">"请输入密钥k\n"</span>);</span><br><span class="line">		    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;k);</span><br><span class="line">	    	<span class="keyword">if</span>(m==<span class="number">1</span>)</span><br><span class="line">		    {   </span><br><span class="line">		    	<span class="type">char</span> ch,c[<span class="number">10000</span>]={<span class="number">0</span>},e[<span class="number">10000</span>]={<span class="number">0</span>};</span><br><span class="line">		        fpr = <span class="built_in">fopen</span>(<span class="string">"text.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">		        fpw = <span class="built_in">fopen</span>(<span class="string">"c.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">		        <span class="keyword">if</span>(fpr==<span class="literal">NULL</span>)</span><br><span class="line">		        {</span><br><span class="line">		            <span class="built_in">printf</span>(<span class="string">"open file error\n"</span>);</span><br><span class="line">		            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			    }</span><br><span class="line">		        <span class="keyword">while</span>(<span class="built_in">fscanf</span>(fpr,<span class="string">"%c"</span>,&amp;ch)!=EOF)</span><br><span class="line">		        {</span><br><span class="line">		            c[i] = ch;</span><br><span class="line">		            i++;</span><br><span class="line">		            len++;</span><br><span class="line">		        }</span><br><span class="line">		        <span class="comment">//printf("%s",c);</span></span><br><span class="line">		        <span class="built_in">encrypt</span>(c,len,k,e,fpw);</span><br><span class="line">		        <span class="built_in">fclose</span>(fpr);</span><br><span class="line">				<span class="built_in">fclose</span>(fpw);</span><br><span class="line">		    }</span><br><span class="line">		    <span class="keyword">else</span> <span class="keyword">if</span>(m==<span class="number">2</span>)</span><br><span class="line">		    {</span><br><span class="line">		    	<span class="type">char</span> ch,c[<span class="number">10000</span>]={<span class="number">0</span>},d[<span class="number">10000</span>]={<span class="number">0</span>};</span><br><span class="line">		        fpr = <span class="built_in">fopen</span>(<span class="string">"c.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">		        fpw = <span class="built_in">fopen</span>(<span class="string">"m1.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">		        <span class="keyword">if</span>(fpr==<span class="literal">NULL</span>)</span><br><span class="line">		        {</span><br><span class="line">		            <span class="built_in">printf</span>(<span class="string">"open file error\n"</span>);</span><br><span class="line">		            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			    }</span><br><span class="line">		        <span class="keyword">while</span>(<span class="built_in">fscanf</span>(fpr,<span class="string">"%c"</span>,&amp;ch)!=EOF)</span><br><span class="line">		        {</span><br><span class="line">		            c[i] = ch;</span><br><span class="line">		            i++;</span><br><span class="line">		            len++;</span><br><span class="line">		        }</span><br><span class="line">		        <span class="built_in">decrypt</span>(c,len,k,d,fpw);</span><br><span class="line">		        <span class="built_in">fclose</span>(fpr);</span><br><span class="line">				<span class="built_in">fclose</span>(fpw);</span><br><span class="line">		    }</span><br><span class="line">		}</span><br><span class="line">	<span class="comment">//}while(m!=0);</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>编译运行<code>Caser.exe</code>，查看结果并用实验室电脑验证。</p>
<p>明文为 <code>liubohan</code>，加密密文是<code>olxerkdq</code>，再次用自己的代码解密与明文相同，同时使用实验室工具验证，正确。</p>
<p><img src="/2023/05/19/Crypto-lab/Crypto-lab/image-20230519150117590.png" alt="image-20230519150117590"></p>
<p><img src="/2023/05/19/Crypto-lab/Crypto-lab/default.jpg" alt="default"></p>
<h3 id="单表置换"><a href="#单表置换" class="headerlink" title="单表置换"></a>单表置换</h3><p>加密：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">char</span> *k)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    FILE *fp1 = <span class="built_in">fopen</span>(<span class="string">"text.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">    FILE *fp2 = <span class="built_in">fopen</span>(<span class="string">"c.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span>(fp1==<span class="literal">NULL</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"error!\n"</span>);</span><br><span class="line">        exit;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>,len=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> a[<span class="number">10000</span>],ch;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fscanf</span>(fp1,<span class="string">"%c"</span>,&amp;ch)!=EOF)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(ch&gt;=<span class="string">'a'</span>&amp;&amp;ch&lt;=<span class="string">'z'</span>)</span><br><span class="line">            a[i] = <span class="built_in">toupper</span>(ch); <span class="comment">//转为大写字母</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            a[i] = ch;</span><br><span class="line">        i++;</span><br><span class="line">        len++;</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// printf("%d\n",len);</span></span><br><span class="line">    <span class="comment">// printf("%s\n",a);</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(a[i]&gt;=<span class="string">'A'</span>&amp;&amp;a[i]&lt;=<span class="string">'Z'</span>)</span><br><span class="line">            a[i] = k[a[i] -<span class="string">'A'</span>];</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// printf("%s\n",a);</span></span><br><span class="line">    <span class="built_in">fputs</span>(a,fp2);</span><br><span class="line">    <span class="built_in">fclose</span>(fp1);</span><br><span class="line">    <span class="built_in">fclose</span>(fp2);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>解密：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">char</span> *k)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    FILE *fp1 = <span class="built_in">fopen</span>(<span class="string">"c.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">    FILE *fp2 = <span class="built_in">fopen</span>(<span class="string">"m1.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span>(fp1==<span class="literal">NULL</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"error!\n"</span>);</span><br><span class="line">        exit;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">char</span> b[<span class="number">10000</span>]={<span class="number">0</span>},ch;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>,len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fscanf</span>(fp1,<span class="string">"%c"</span>,&amp;ch)!=EOF)</span><br><span class="line">    {</span><br><span class="line">        b[i] = ch;</span><br><span class="line">        i++;</span><br><span class="line">        len++;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(b[i]&gt;=<span class="string">'A'</span>&amp;&amp;b[i]&lt;=<span class="string">'Z'</span>)</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">26</span>;j++)</span><br><span class="line">            {</span><br><span class="line">                <span class="keyword">if</span>(k[j]==b[i])</span><br><span class="line">                    b[i] = <span class="string">'a'</span> + j;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">fputs</span>(b,fp2);</span><br><span class="line">    <span class="built_in">fclose</span>(fp1);</span><br><span class="line">    <span class="built_in">fclose</span>(fp2);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>main函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    FILE *fp1,*fp2;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> m;</span><br><span class="line">    <span class="comment">//do</span></span><br><span class="line">    <span class="comment">//{</span></span><br><span class="line">	    <span class="built_in">printf</span>(<span class="string">"请输入工作模式：1.加密；2.解密；\n"</span>);</span><br><span class="line">	    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line">		<span class="keyword">if</span>(m!=<span class="number">0</span>&amp;&amp;m!=<span class="number">1</span>&amp;&amp;m!=<span class="number">2</span>)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"输入有误！\n"</span>);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		{</span><br><span class="line">			<span class="type">char</span> k[<span class="number">26</span>]={<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>,<span class="string">'E'</span>,<span class="string">'F'</span>,<span class="string">'G'</span>,<span class="string">'H'</span>,<span class="string">'I'</span>,<span class="string">'J'</span>,<span class="string">'K'</span>,<span class="string">'L'</span>,<span class="string">'M'</span>,<span class="string">'N'</span>,<span class="string">'O'</span>,<span class="string">'P'</span>,<span class="string">'Q'</span>,<span class="string">'R'</span>,<span class="string">'S'</span>,<span class="string">'T'</span>,<span class="string">'U'</span>,<span class="string">'V'</span>,<span class="string">'W'</span>,<span class="string">'X'</span>,<span class="string">'Y'</span>,<span class="string">'Z'</span>},</span><br><span class="line">	    	*c,*s;</span><br><span class="line">	    	c = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">char</span>));</span><br><span class="line">	    	s = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">char</span>));</span><br><span class="line">			<span class="built_in">getchar</span>();</span><br><span class="line">		    <span class="built_in">printf</span>(<span class="string">"请输入密钥：\n"</span>);    </span><br><span class="line">		    <span class="built_in">scanf</span>(<span class="string">"%[^\n]"</span>,c);</span><br><span class="line">		    <span class="type">int</span> len = <span class="built_in">strlen</span>(c);</span><br><span class="line">		    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;i&lt;len;i++,j++)</span><br><span class="line">		    {</span><br><span class="line">		        <span class="keyword">if</span>(<span class="built_in">isupper</span>(c[i]))</span><br><span class="line">		            s[j] = c[i];</span><br><span class="line">		        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">islower</span>(c[i]))</span><br><span class="line">		            s[j] = <span class="built_in">toupper</span>(c[i]);</span><br><span class="line">		        <span class="keyword">else</span></span><br><span class="line">		            j--;</span><br><span class="line">		    }</span><br><span class="line">		    len = <span class="built_in">strlen</span>(s);</span><br><span class="line">		    <span class="type">int</span> flag = <span class="number">0</span>;</span><br><span class="line">		    <span class="type">int</span> min = <span class="number">26</span>;</span><br><span class="line">		    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">		    {</span><br><span class="line">		        <span class="type">int</span> temp = <span class="number">1</span>;</span><br><span class="line">		        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;flag;j++)</span><br><span class="line">		        {</span><br><span class="line">		            <span class="keyword">if</span>(s[i]==k[j])</span><br><span class="line">		            {</span><br><span class="line">		                temp = <span class="number">0</span>;</span><br><span class="line">		                <span class="keyword">break</span>;</span><br><span class="line">		            }</span><br><span class="line">		        }</span><br><span class="line">		        <span class="keyword">if</span>(temp)</span><br><span class="line">		        {</span><br><span class="line">		            <span class="keyword">if</span>(s[i]!=k[flag])</span><br><span class="line">		            { </span><br><span class="line">		                <span class="type">int</span> n = (s[i]-<span class="string">'A'</span>&gt;min)?s[i]-<span class="string">'A'</span>:flag+s[i]-<span class="string">'A'</span>;</span><br><span class="line">		                <span class="keyword">for</span>(n;n&gt;flag;n--)</span><br><span class="line">		                {</span><br><span class="line">		                    k[n] = k[n<span class="number">-1</span>];</span><br><span class="line">		                }</span><br><span class="line">		                k[flag] = s[i];       </span><br><span class="line">		            }</span><br><span class="line">		            flag++;</span><br><span class="line">		            <span class="keyword">if</span>(s[i]-<span class="string">'A'</span>&lt;min)</span><br><span class="line">		                min = s[i]-<span class="string">'A'</span>;</span><br><span class="line">		        }</span><br><span class="line">		    }</span><br><span class="line">		    <span class="comment">// printf("%s\n",k);</span></span><br><span class="line">		</span><br><span class="line">		    <span class="keyword">if</span>(m==<span class="number">1</span>)</span><br><span class="line">		    {</span><br><span class="line">		        <span class="built_in">encrypt</span>(k);</span><br><span class="line">		        <span class="comment">//printf("加密成功\n"); </span></span><br><span class="line">		    }</span><br><span class="line">		    <span class="keyword">else</span> <span class="keyword">if</span>(m==<span class="number">2</span>)</span><br><span class="line">		    {</span><br><span class="line">		        <span class="built_in">decrypt</span>(k);</span><br><span class="line">		        <span class="comment">//printf("解密成功\n");</span></span><br><span class="line">		    }</span><br><span class="line">		}</span><br><span class="line">	    </span><br><span class="line">	<span class="comment">//}while(m!=0);</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/19/Crypto-lab/Crypto-lab/image-20230519152004798.png" alt="image-20230519152004798"></p>
<h3 id="仿射"><a href="#仿射" class="headerlink" title="仿射"></a>仿射</h3><p>原理：</p>
<p>加密：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex" xmlns="http://www.w3.org/2000/svg" width="23.622ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 10441 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"/></g><g data-mml-node="mo" transform="translate(466,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(855,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(1427,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(2093.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mo" transform="translate(3149.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(3538.6,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"/></g><g data-mml-node="mi" transform="translate(4067.6,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(4861.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(5862,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"/></g><g data-mml-node="mo" transform="translate(6291,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mi" transform="translate(6680,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(7558,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/></g><g data-mml-node="mi" transform="translate(8043,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="mstyle" transform="translate(8563,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mi" transform="translate(9563,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g></g></g></svg></mjx-container></p>
<p>解密：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex" xmlns="http://www.w3.org/2000/svg" width="25.977ex" height="2.452ex" role="img" focusable="false" viewbox="0 -833.9 11481.7 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="mo" transform="translate(520,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(909,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(1481,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mo" transform="translate(2147.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="msup" transform="translate(3203.6,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"/></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(4719.2,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(5108.2,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/></g><g data-mml-node="mo" transform="translate(5902.5,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mi" transform="translate(6902.7,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"/></g><g data-mml-node="mo" transform="translate(7331.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mi" transform="translate(7720.7,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(8598.7,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/></g><g data-mml-node="mi" transform="translate(9083.7,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="mstyle" transform="translate(9603.7,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mi" transform="translate(10603.7,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g></g></g></svg></mjx-container></p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.023ex" xmlns="http://www.w3.org/2000/svg" width="1.197ex" height="1.02ex" role="img" focusable="false" viewbox="0 -441 529 451"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"/></g></g></g></svg></mjx-container>与<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex" xmlns="http://www.w3.org/2000/svg" width="1.986ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 878 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g></g></g></svg></mjx-container>互质，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.023ex" xmlns="http://www.w3.org/2000/svg" width="3.429ex" height="1.909ex" role="img" focusable="false" viewbox="0 -833.9 1515.7 843.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"/></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g></g></g></g></svg></mjx-container>是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.023ex" xmlns="http://www.w3.org/2000/svg" width="1.197ex" height="1.02ex" role="img" focusable="false" viewbox="0 -441 529 451"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"/></g></g></g></svg></mjx-container>在<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex" xmlns="http://www.w3.org/2000/svg" width="3.138ex" height="1.902ex" role="img" focusable="false" viewbox="0 -683 1386.8 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44D" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z"/></g><g data-mml-node="TeXAtom" transform="translate(716,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g></g></g></g></g></svg></mjx-container>群中的逆元。</p>
<h4 id="求逆元"><a href="#求逆元" class="headerlink" title="求逆元"></a>求逆元</h4><p>1.凑数 2.费马小定理 3.欧几里得扩展算法</p>
<p>此处做一下1和2</p>
<p>1：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">getinverse</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;m;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>( (i*a) % m == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>2：</p>
<p>当 m 为质数时，有：</p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex" xmlns="http://www.w3.org/2000/svg" width="16.74ex" height="1.912ex" role="img" focusable="false" viewbox="0 -833.9 7399.1 844.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"/></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(878,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(1656,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g></g><g data-mml-node="mo" transform="translate(2414.3,0)"><path data-c="2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z"/></g><g data-mml-node="mn" transform="translate(3470.1,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g><g data-mml-node="mstyle" transform="translate(3970.1,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mstyle" transform="translate(4137.1,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mi" transform="translate(4304.1,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(5182.1,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/></g><g data-mml-node="mi" transform="translate(5667.1,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="mstyle" transform="translate(6187.1,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mstyle" transform="translate(6354.1,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mi" transform="translate(6521.1,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g></g></g></svg></mjx-container></p>
<p>即有 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex" xmlns="http://www.w3.org/2000/svg" width="20.074ex" height="1.912ex" role="img" focusable="false" viewbox="0 -833.9 8872.5 844.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"/></g><g data-mml-node="mo" transform="translate(751.2,0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"/></g><g data-mml-node="msup" transform="translate(1473.4,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"/></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(878,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mn" transform="translate(1656,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g><g data-mml-node="mo" transform="translate(3887.7,0)"><path data-c="2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z"/></g><g data-mml-node="mn" transform="translate(4943.5,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g><g data-mml-node="mstyle" transform="translate(5443.5,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mstyle" transform="translate(5610.5,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mi" transform="translate(5777.5,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(6655.5,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/></g><g data-mml-node="mi" transform="translate(7140.5,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="mstyle" transform="translate(7660.5,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mstyle" transform="translate(7827.5,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mi" transform="translate(7994.5,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g></g></g></svg></mjx-container></p>
<h4 id="最大公约数"><a href="#最大公约数" class="headerlink" title="最大公约数"></a>最大公约数</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">while</span>(b!=<span class="number">0</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">int</span> temp = a;</span><br><span class="line">        a = b;</span><br><span class="line">        b = temp % b;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="素性判断"><a href="#素性判断" class="headerlink" title="素性判断"></a>素性判断</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">ifisPrime</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">gcd</span>(a,b)==<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="type">int</span> m = <span class="number">26</span>,i=<span class="number">0</span>,len=<span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> c[<span class="number">10000</span>] = {<span class="number">0</span>},ch;</span><br><span class="line">    FILE *fp1,*fp2;</span><br><span class="line">    fp1 = <span class="built_in">fopen</span>(<span class="string">"text.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">    fp2 = <span class="built_in">fopen</span>(<span class="string">"c.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span>(fp1==<span class="literal">NULL</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"error!\n"</span>);</span><br><span class="line">        exit;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fscanf</span>(fp1,<span class="string">"%c"</span>,&amp;ch)!=EOF)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">islower</span>(ch))</span><br><span class="line">            c[i] = <span class="built_in">toupper</span>(ch);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            c[i] = ch;</span><br><span class="line">        i++;</span><br><span class="line">    }</span><br><span class="line">    len = <span class="built_in">strlen</span>(c);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">isupper</span>(c[i]))</span><br><span class="line">            c[i] = <span class="string">'A'</span> + ( (a * (c[i] - <span class="string">'A'</span>) + b) % <span class="number">26</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">fputs</span>(c,fp2);</span><br><span class="line">    <span class="built_in">fclose</span>(fp1);</span><br><span class="line">    <span class="built_in">fclose</span>(fp2);</span><br><span class="line">    <span class="comment">//printf("加密成功\n");</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    FILE *fp1,*fp2;</span><br><span class="line">    fp1 = <span class="built_in">fopen</span>(<span class="string">"c.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">    fp2 = <span class="built_in">fopen</span>(<span class="string">"m1.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span>(fp1==<span class="literal">NULL</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"error!\n"</span>);</span><br><span class="line">        exit;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">char</span> c[<span class="number">10000</span>] = {<span class="number">0</span>},ch;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>,len=<span class="number">0</span>,inva = <span class="built_in">getinverse</span>(a,<span class="number">26</span>);</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fscanf</span>(fp1,<span class="string">"%c"</span>,&amp;ch)!=EOF)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">isupper</span>(ch))</span><br><span class="line">            c[i] = <span class="built_in">tolower</span>(ch);</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            c[i] = ch;</span><br><span class="line">        i++;</span><br><span class="line">    }</span><br><span class="line">    len = <span class="built_in">strlen</span>(c);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">islower</span>(c[i]))</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">if</span>((c[i] - <span class="string">'a'</span>) &lt; b)</span><br><span class="line">                c[i] = ( inva * (c[i] - <span class="string">'a'</span> - b + <span class="number">26</span>) % <span class="number">26</span>) + <span class="string">'a'</span>; </span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                c[i] = ( inva * (c[i] - <span class="string">'a'</span> - b)  % <span class="number">26</span>) + <span class="string">'a'</span>; </span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">fputs</span>(c,fp2);</span><br><span class="line">    <span class="built_in">fclose</span>(fp1);</span><br><span class="line">    <span class="built_in">fclose</span>(fp2);</span><br><span class="line">    <span class="comment">//printf("解密成功\n");</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="main函数"><a href="#main函数" class="headerlink" title="main函数"></a>main函数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="type">int</span> a,b,m;</span><br><span class="line">    <span class="comment">//do</span></span><br><span class="line">	<span class="comment">//{</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"请输入工作模式：1.加密；2.解密；\n"</span>);</span><br><span class="line">    	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line">    	<span class="keyword">if</span>(m!=<span class="number">0</span>&amp;&amp;m!=<span class="number">1</span>&amp;&amp;m!=<span class="number">2</span>)</span><br><span class="line">    		<span class="built_in">printf</span>(<span class="string">"输入有误！\n"</span>);</span><br><span class="line">    	<span class="keyword">else</span></span><br><span class="line">    	{</span><br><span class="line">		    <span class="built_in">printf</span>(<span class="string">"请输入密钥a、b，其中a与26互素\n"</span>);</span><br><span class="line">		    <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>,&amp;a,&amp;b);</span><br><span class="line">		    <span class="keyword">if</span>(!(ifisPrime(a,<span class="number">26</span>)))</span><br><span class="line">		    {</span><br><span class="line">		        <span class="keyword">while</span>(!(ifisPrime(a,<span class="number">26</span>)))</span><br><span class="line">		        {</span><br><span class="line">		            <span class="built_in">printf</span>(<span class="string">"请输入与26互素的a!\n"</span>);</span><br><span class="line">		            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a);</span><br><span class="line">		        }</span><br><span class="line">		    }</span><br><span class="line">		    <span class="keyword">if</span>(m==<span class="number">1</span>)</span><br><span class="line">		        <span class="built_in">encrypt</span>(a,b);</span><br><span class="line">		    <span class="keyword">else</span> <span class="keyword">if</span>(m==<span class="number">2</span>)</span><br><span class="line">		        <span class="built_in">decrypt</span>(a,b);</span><br><span class="line">		}</span><br><span class="line">	<span class="comment">//}while(m!=0); </span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/19/Crypto-lab/Crypto-lab/image-20230519154308554.png" alt="image-20230519154308554"></p>
<p>密钥选了7和9。</p>
<p><img src="/2023/05/19/Crypto-lab/Crypto-lab/default (1" alt="default (1)">.jpg)</p>
<h2 id="对称密码"><a href="#对称密码" class="headerlink" title="对称密码"></a>对称密码</h2><h3 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h3><p>请移步 DES 专区，这里贴实验结果</p>
<p><img src="/2023/05/19/Crypto-lab/Crypto-lab/image-20230519155027113.png" alt="image-20230519155027113"></p>
<p><img src="/2023/05/19/Crypto-lab/Crypto-lab/image-20230519155055392.png" alt="image-20230519155055392"></p>
<p><img src="/2023/05/19/Crypto-lab/Crypto-lab/default (2" alt="default (2)">.jpg)</p>
<h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><h2 id="非对称密码-RSA"><a href="#非对称密码-RSA" class="headerlink" title="非对称密码 RSA"></a>非对称密码 RSA</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//int Plaintext[100];//明文</span></span><br><span class="line"><span class="comment">//long long Ciphertext[100];//密文</span></span><br><span class="line"><span class="type">int</span> n, e = <span class="number">0</span>, d;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//二进制转换</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">BianaryTransform</span><span class="params">(<span class="type">int</span> num, <span class="type">int</span> bin_num[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line"> </span><br><span class="line">	<span class="type">int</span> i = <span class="number">0</span>,  mod = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">//转换为二进制，逆向暂存temp[]数组中</span></span><br><span class="line">	<span class="keyword">while</span>(num != <span class="number">0</span>)</span><br><span class="line">	{</span><br><span class="line">		mod = num%<span class="number">2</span>;</span><br><span class="line">		bin_num[i] = mod;</span><br><span class="line">		num = num/<span class="number">2</span>;</span><br><span class="line">		i++;</span><br><span class="line">	}</span><br><span class="line"> </span><br><span class="line">	<span class="comment">//返回二进制数的位数</span></span><br><span class="line">	<span class="keyword">return</span> i;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">//反复平方求幂 并取余 </span></span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">Modular_Exonentiation</span><span class="params">(<span class="type">long</span> <span class="type">long</span> a, <span class="type">int</span> b, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> c = <span class="number">0</span>, bin_num[<span class="number">1000</span>];</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> d = <span class="number">1</span>;</span><br><span class="line">	<span class="type">int</span> k = <span class="built_in">BianaryTransform</span>(b, bin_num)<span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = k; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">	{</span><br><span class="line">		c = <span class="number">2</span>*c;</span><br><span class="line">		d = (d*d)%n;</span><br><span class="line">		<span class="keyword">if</span>(bin_num[i] == <span class="number">1</span>)</span><br><span class="line">		{</span><br><span class="line">			c = c + <span class="number">1</span>;</span><br><span class="line">			d = (d*a)%n;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">//生成1000以内素数,并存储在数组里 </span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ProducePrimeNumber</span><span class="params">(<span class="type">int</span> prime[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> c = <span class="number">0</span>, vis[<span class="number">1001</span>];</span><br><span class="line">	<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));<span class="comment">//初始值设为0 </span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">1000</span>; i++)<span class="keyword">if</span>(!vis[i])</span><br><span class="line">	{</span><br><span class="line">		prime[c++] = i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = i*i; j &lt;= <span class="number">1000</span>; j+=i)</span><br><span class="line">			vis[j] = <span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Exgcd</span><span class="params">(<span class="type">int</span> m,<span class="type">int</span> n,<span class="type">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> x1,y1,x0,y0, y;</span><br><span class="line">	x0=<span class="number">1</span>; y0=<span class="number">0</span>;</span><br><span class="line">	x1=<span class="number">0</span>; y1=<span class="number">1</span>;</span><br><span class="line">	x=<span class="number">0</span>; y=<span class="number">1</span>;</span><br><span class="line">	<span class="type">int</span> r=m%n;</span><br><span class="line">	<span class="type">int</span> q=(m-r)/n;</span><br><span class="line">	<span class="keyword">while</span>(r)</span><br><span class="line">	{</span><br><span class="line">		x=x0-q*x1; y=y0-q*y1;</span><br><span class="line">		x0=x1; y0=y1;</span><br><span class="line">		x1=x; y1=y;</span><br><span class="line">		m=n; n=r; r=m%n;</span><br><span class="line">		q=(m-r)/n;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> n;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">//RSA初始化</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RSA_Initialize</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="comment">//取出1000内素数保存在prime[]数组中</span></span><br><span class="line">	<span class="type">int</span> prime[<span class="number">5000</span>];</span><br><span class="line">	<span class="type">int</span> count_Prime = <span class="built_in">ProducePrimeNumber</span>(prime);</span><br><span class="line"> </span><br><span class="line">	<span class="comment">//随机取两个素数p,q</span></span><br><span class="line">	<span class="built_in">srand</span>((<span class="type">unsigned</span>)<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line">	<span class="type">int</span> ranNum1 = <span class="built_in">rand</span>()%count_Prime;</span><br><span class="line">	<span class="type">int</span> ranNum2 = <span class="built_in">rand</span>()%count_Prime;</span><br><span class="line">	<span class="type">int</span> p = prime[ranNum1], q = prime[ranNum2];</span><br><span class="line"> </span><br><span class="line">	n = p*q;</span><br><span class="line"> </span><br><span class="line">	<span class="type">int</span> On = (p<span class="number">-1</span>)*(q<span class="number">-1</span>);<span class="comment">//计算乘积 </span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">	<span class="comment">//e与On互素 </span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">3</span>; j &lt; On; j+=<span class="number">1331</span>)</span><br><span class="line">	{</span><br><span class="line">		<span class="type">int</span> gcd = <span class="built_in">Exgcd</span>(j, On, d);<span class="comment">//私钥d </span></span><br><span class="line">		<span class="keyword">if</span>( gcd == <span class="number">1</span> &amp;&amp; d &gt; <span class="number">0</span>)</span><br><span class="line">		{</span><br><span class="line">			e = j;<span class="comment">//公钥e </span></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line"> </span><br><span class="line">	}</span><br><span class="line"> </span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">//RSA加密   C = Ek(m) = m^e mod n； (e,n)是公钥 m明文 </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RSA_Encrypt</span><span class="params">(<span class="type">int</span> a[],<span class="type">int</span> b[],<span class="type">int</span> length)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	cout&lt;&lt;<span class="string">"公钥(e, n): e = "</span>&lt;&lt;e&lt;&lt;<span class="string">" n = "</span>&lt;&lt;n&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">	cout&lt;&lt;<span class="string">"私钥(d, n): d = "</span>&lt;&lt;d&lt;&lt;<span class="string">" n = "</span>&lt;&lt;n&lt;&lt;<span class="string">'\n'</span>&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line"> </span><br><span class="line">	<span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">		b[i] = <span class="built_in">Modular_Exonentiation</span>(a[i], e, n);<span class="comment">//明文e次方mod n </span></span><br><span class="line"> </span><br><span class="line">	cout&lt;&lt;<span class="string">"公钥加密:"</span>&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">		cout&lt;&lt;b[i]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">	cout&lt;&lt;<span class="string">'\n'</span>&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">//RSA解密</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RSA_Decrypt</span><span class="params">(<span class="type">int</span> b[],<span class="type">int</span> a[],<span class="type">int</span> length)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">		a[i] = <span class="built_in">Modular_Exonentiation</span>(b[i], d, n);<span class="comment">//密文d次方mod n </span></span><br><span class="line"> </span><br><span class="line">	cout&lt;&lt;<span class="string">"私钥解密:"</span>&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">		cout&lt;&lt;a[i]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">	cout&lt;&lt;<span class="string">'\n'</span>&lt;&lt;<span class="string">'\n'</span>;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="comment">//Initialize();</span></span><br><span class="line"> 	ifstream in;</span><br><span class="line"> 	in.<span class="built_in">open</span>(<span class="string">"RSA明文.txt"</span>,ios::in);</span><br><span class="line"> 	<span class="type">int</span> a[<span class="number">100</span>];<span class="comment">//存储明文 </span></span><br><span class="line"> 	<span class="type">int</span> b[<span class="number">100</span>]; <span class="comment">//存储密文 </span></span><br><span class="line"> 	<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line"> 	<span class="keyword">while</span>(!in.<span class="built_in">eof</span>()){</span><br><span class="line"> 		in&gt;&gt;a[i];</span><br><span class="line"> 		i++;</span><br><span class="line">	}</span><br><span class="line">	i--;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(!e)</span><br><span class="line">		<span class="built_in">RSA_Initialize</span>();<span class="comment">//得到n,e,d   //随机生成两个大素数p和q 计算n 和On，用欧几里得扩展算法求出e，ed=1%On，=&gt;d </span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">RSA_Encrypt</span>(a,b,i);  <span class="comment">//C = Ek(m) = m^e mod n； (e,n)是公钥 m明文 </span></span><br><span class="line">	ofstream out;</span><br><span class="line">	out.<span class="built_in">open</span>(<span class="string">"RSA密文.txt"</span>,ios::out);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;i;j++){</span><br><span class="line">		out&lt;&lt;b[j]&lt;&lt;endl;</span><br><span class="line">	}</span><br><span class="line">	out.<span class="built_in">close</span>();</span><br><span class="line">	in.<span class="built_in">close</span>(); </span><br><span class="line">	i=<span class="number">0</span>;</span><br><span class="line">	<span class="comment">//下面为解密 </span></span><br><span class="line">	in.<span class="built_in">open</span>(<span class="string">"RSA密文.txt"</span>,ios::in);  <span class="comment">//m = Dk（C）= C^d mod n。 (d,n)是私钥 </span></span><br><span class="line">	<span class="type">int</span> c[<span class="number">100</span>];</span><br><span class="line">	<span class="type">int</span> d[<span class="number">100</span>];<span class="comment">//存储明文 </span></span><br><span class="line">	<span class="keyword">while</span>(!in.<span class="built_in">eof</span>()){</span><br><span class="line"> 		in&gt;&gt;c[i];</span><br><span class="line"> 		i++;</span><br><span class="line">	}</span><br><span class="line">	i--;</span><br><span class="line">	<span class="built_in">RSA_Decrypt</span>(c,d,i);</span><br><span class="line">	out.<span class="built_in">open</span>(<span class="string">"RSA解密后明文.txt"</span>,ios::out);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;i;j++){</span><br><span class="line">		out&lt;&lt;d[j]&lt;&lt;endl;</span><br><span class="line">	}</span><br><span class="line">	out.<span class="built_in">close</span>();</span><br><span class="line">	in.<span class="built_in">close</span>(); </span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/19/Crypto-lab/Crypto-lab/image-20230519160240930.png" alt="image-20230519160240930"></p>
<h2 id="Hash-MD5"><a href="#Hash-MD5" class="headerlink" title="Hash MD5"></a>Hash MD5</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*各函数声明*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shizhuaner</span><span class="params">(<span class="type">int</span> in, <span class="type">int</span> n, <span class="type">int</span> *md5)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shizhuaner_weishu</span><span class="params">(<span class="type">int</span> in, <span class="type">int</span> *md5)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shiliuzhuaner</span><span class="params">(<span class="type">char</span> *t, <span class="type">int</span> *temp)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">c_out</span><span class="params">(<span class="type">int</span> *a)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">abcd_out</span><span class="params">(<span class="type">int</span> *a)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F</span><span class="params">(<span class="type">int</span> *b, <span class="type">int</span> *c, <span class="type">int</span> *d, <span class="type">int</span> *temp1, <span class="type">int</span> *temp2)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">G</span><span class="params">(<span class="type">int</span> *b, <span class="type">int</span> *c, <span class="type">int</span> *d, <span class="type">int</span> *temp1, <span class="type">int</span> *temp2)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">H</span><span class="params">(<span class="type">int</span> *b, <span class="type">int</span> *c, <span class="type">int</span> *d, <span class="type">int</span> *temp)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">I</span><span class="params">(<span class="type">int</span> *b, <span class="type">int</span> *c, <span class="type">int</span> *d, <span class="type">int</span> *temp)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">yu</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> *temp)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">huo</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> *temp)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fei</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *temp)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">yihuo</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> *temp)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">jia</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> *temp)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> out[<span class="number">100</span>]={<span class="number">0</span>};</span><br><span class="line"><span class="type">int</span> o=<span class="number">0</span>;</span><br><span class="line"><span class="comment">/*十进制转二进制函数*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shizhuaner</span><span class="params">(<span class="type">int</span> in, <span class="type">int</span> n, <span class="type">int</span> *md5)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> j, s, w;  </span><br><span class="line">	s = n / <span class="number">4</span> + <span class="number">1</span>;  <span class="comment">//s是md5里面组的排位数，w是该组里面的位数</span></span><br><span class="line">	w = n % <span class="number">4</span>;</span><br><span class="line">	j = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	{</span><br><span class="line">		md5[<span class="number">32</span> * s - <span class="number">8</span> * w - j] = in % <span class="number">2</span>;</span><br><span class="line">		in = in / <span class="number">2</span>;</span><br><span class="line">		j++;</span><br><span class="line">	} <span class="keyword">while</span> (in != <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">while</span> (j &lt;=<span class="number">8</span>)  <span class="comment">//二进制不够八位时补零</span></span><br><span class="line">	{</span><br><span class="line">		md5[<span class="number">32</span> * s - <span class="number">8</span> * w - j] = <span class="number">0</span>;</span><br><span class="line">		j++;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 位数填充时所用到的十进制转二进制函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shizhuaner_weishu</span><span class="params">(<span class="type">int</span> in, <span class="type">int</span> *md5)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i,j,temp, a[<span class="number">64</span>];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; in!= <span class="number">0</span>; i++)</span><br><span class="line">	{</span><br><span class="line">		a[i] = in % <span class="number">2</span>;</span><br><span class="line">		in = in / <span class="number">2</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">while</span> (i % <span class="number">8</span> != <span class="number">0</span>)  <span class="comment">//二进制位数不够八的整数倍时补零</span></span><br><span class="line">	{</span><br><span class="line">		a[i] = <span class="number">0</span>;</span><br><span class="line">		i++;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt;i/<span class="number">2</span>; j++)</span><br><span class="line">	{</span><br><span class="line">		temp = a[i - j - <span class="number">1</span>];</span><br><span class="line">		a[i - j<span class="number">-1</span>] = a[j];</span><br><span class="line">		a[j] = temp;</span><br><span class="line">		</span><br><span class="line">	}</span><br><span class="line">	temp = i/<span class="number">8</span>;</span><br><span class="line">	<span class="keyword">for</span> (i=i<span class="number">-1</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">		a[i] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) </span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">			md5[<span class="number">512</span> - temp * <span class="number">8</span> + j - <span class="number">32</span>] = a[i * <span class="number">8</span> + j];</span><br><span class="line">		temp = temp - <span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">			md5[<span class="number">512</span> - (i + <span class="number">1</span>) * <span class="number">8</span> + j ] = a[i * <span class="number">8</span> + j+<span class="number">32</span>];</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 十六进制转二进制函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shiliuzhuaner</span><span class="params">(<span class="type">char</span> *t, <span class="type">int</span> *temp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">switch</span> (t[i])</span><br><span class="line">		{</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'0'</span>:{temp[<span class="number">4</span> * i] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">0</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'1'</span>:{temp[<span class="number">4</span> * i] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">1</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'2'</span>:{temp[<span class="number">4</span> * i] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">0</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'3'</span>:{temp[<span class="number">4</span> * i] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">1</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'4'</span>:{temp[<span class="number">4</span> * i] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">0</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'5'</span>:{temp[<span class="number">4</span> * i] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">1</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'6'</span>:{temp[<span class="number">4</span> * i] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">0</span>; }<span class="keyword">break</span>; </span><br><span class="line">		<span class="keyword">case</span> <span class="string">'7'</span>:{temp[<span class="number">4</span> * i] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">1</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'8'</span>:{temp[<span class="number">4</span> * i] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">0</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'9'</span>:{temp[<span class="number">4</span> * i] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">1</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'a'</span>:{temp[<span class="number">4</span> * i] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">0</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'b'</span>:{temp[<span class="number">4</span> * i] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">1</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'c'</span>:{temp[<span class="number">4</span> * i] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">0</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'d'</span>:{temp[<span class="number">4</span> * i] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">0</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">1</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'e'</span>:{temp[<span class="number">4</span> * i] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">0</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'f'</span>:{temp[<span class="number">4</span> * i] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">1</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">2</span>] = <span class="number">1</span>; temp[<span class="number">4</span> * i + <span class="number">3</span>] = <span class="number">1</span>; }<span class="keyword">break</span>;	</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 密文输出函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">c_out</span><span class="params">(<span class="type">int</span> *a)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i,add;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++)  <span class="comment">//二进制转换成十六进制输出</span></span><br><span class="line">	{</span><br><span class="line">		add = a[<span class="number">32</span> - i * <span class="number">8</span>] * <span class="number">8</span> + a[<span class="number">32</span> - i * <span class="number">8</span> + <span class="number">1</span>] * <span class="number">4</span> + a[<span class="number">32</span> - i * <span class="number">8</span> + <span class="number">2</span>] * <span class="number">2</span> + a[<span class="number">32</span> - i * <span class="number">8</span> + <span class="number">3</span>];</span><br><span class="line">		<span class="keyword">if</span> (add &gt;= <span class="number">10</span>)</span><br><span class="line">		{</span><br><span class="line">			<span class="keyword">switch</span> (add)</span><br><span class="line">			{</span><br><span class="line">			<span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">				{</span><br><span class="line">					<span class="comment">//printf("a"); </span></span><br><span class="line">			out[o]=<span class="string">'a'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			<span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">				{</span><br><span class="line">					<span class="comment">//printf("b"); </span></span><br><span class="line">			out[o]=<span class="string">'b'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			<span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">				{</span><br><span class="line">					<span class="comment">//printf("c"); </span></span><br><span class="line">			out[o]=<span class="string">'c'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			<span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">				{</span><br><span class="line">					<span class="comment">//printf("d"); </span></span><br><span class="line">			out[o]=<span class="string">'d'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			<span class="keyword">case</span> <span class="number">14</span>:</span><br><span class="line">				{</span><br><span class="line">					<span class="comment">//printf("e"); </span></span><br><span class="line">			out[o]=<span class="string">'e'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			<span class="keyword">case</span> <span class="number">15</span>:</span><br><span class="line">			{</span><br><span class="line">					<span class="comment">//printf("f"); </span></span><br><span class="line">			out[o]=<span class="string">'f'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		{</span><br><span class="line">			<span class="comment">//printf("%d", add);</span></span><br><span class="line">			<span class="type">char</span> zhong ;</span><br><span class="line">			zhong=add+<span class="string">'0'</span>;</span><br><span class="line">			out[o]=zhong;</span><br><span class="line">			o++;</span><br><span class="line">		}</span><br><span class="line">			<span class="comment">//printf("%d", add);</span></span><br><span class="line">		add = a[<span class="number">32</span> - i * <span class="number">8</span>+<span class="number">4</span>] * <span class="number">8</span> + a[<span class="number">32</span> - i * <span class="number">8</span> + <span class="number">5</span>] * <span class="number">4</span> + a[<span class="number">32</span> - i * <span class="number">8</span> + <span class="number">6</span>] * <span class="number">2</span> + a[<span class="number">32</span> - i * <span class="number">8</span> + <span class="number">7</span>];</span><br><span class="line">		<span class="keyword">if</span> (add &gt;= <span class="number">10</span>)</span><br><span class="line">		{</span><br><span class="line">			<span class="keyword">switch</span> (add)</span><br><span class="line">			{</span><br><span class="line"><span class="comment">//			case 10:printf("a"); break;</span></span><br><span class="line"><span class="comment">//			case 11:printf("b"); break;</span></span><br><span class="line"><span class="comment">//			case 12:printf("c"); break;</span></span><br><span class="line"><span class="comment">//			case 13:printf("d"); break;</span></span><br><span class="line"><span class="comment">//			case 14:printf("e"); break;</span></span><br><span class="line"><span class="comment">//			case 15:printf("f"); break;</span></span><br><span class="line">			<span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">				{</span><br><span class="line">				<span class="comment">//	printf("a"); </span></span><br><span class="line">			out[o]=<span class="string">'a'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			<span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">				{</span><br><span class="line">				<span class="comment">//	printf("b"); </span></span><br><span class="line">			out[o]=<span class="string">'b'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			<span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">				{</span><br><span class="line">				<span class="comment">//	printf("c"); </span></span><br><span class="line">			out[o]=<span class="string">'c'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			<span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">				{</span><br><span class="line">				<span class="comment">//	printf("d"); </span></span><br><span class="line">			out[o]=<span class="string">'d'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			<span class="keyword">case</span> <span class="number">14</span>:</span><br><span class="line">				{</span><br><span class="line">				<span class="comment">//	printf("e"); </span></span><br><span class="line">			out[o]=<span class="string">'e'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			<span class="keyword">case</span> <span class="number">15</span>:</span><br><span class="line">			{</span><br><span class="line">				<span class="comment">//	printf("f"); </span></span><br><span class="line">			out[o]=<span class="string">'f'</span>;</span><br><span class="line">			o++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">			}</span><br><span class="line">		<span class="comment">//	printf("%d", add);</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		{</span><br><span class="line">		<span class="comment">//	printf("%d", add);</span></span><br><span class="line">			<span class="type">char</span> zhong ;</span><br><span class="line">			zhong=add+<span class="string">'0'</span>;</span><br><span class="line">			out[o]=zhong;</span><br><span class="line">			o++;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 中间过程的输出函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">abcd_out</span><span class="params">(<span class="type">int</span> *a)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i, add;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)  <span class="comment">//二进制转换成十六进制输出</span></span><br><span class="line">	{</span><br><span class="line">		add = a[i * <span class="number">8</span>] * <span class="number">8</span> + a[i * <span class="number">8</span> + <span class="number">1</span>] * <span class="number">4</span> + a[i * <span class="number">8</span> + <span class="number">2</span>] * <span class="number">2</span> + a[i * <span class="number">8</span> + <span class="number">3</span>];</span><br><span class="line">		<span class="keyword">if</span> (add &gt;= <span class="number">10</span>)</span><br><span class="line">		{</span><br><span class="line">			<span class="keyword">switch</span> (add)</span><br><span class="line">			{</span><br><span class="line">			<span class="keyword">case</span> <span class="number">10</span>:<span class="built_in">printf</span>(<span class="string">"a"</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">11</span>:<span class="built_in">printf</span>(<span class="string">"b"</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">12</span>:<span class="built_in">printf</span>(<span class="string">"c"</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">13</span>:<span class="built_in">printf</span>(<span class="string">"d"</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">14</span>:<span class="built_in">printf</span>(<span class="string">"e"</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">15</span>:<span class="built_in">printf</span>(<span class="string">"f"</span>); <span class="keyword">break</span>;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d"</span>, add);</span><br><span class="line">		add = a[i * <span class="number">8</span> + <span class="number">4</span>] * <span class="number">8</span> + a[i * <span class="number">8</span> + <span class="number">5</span>] * <span class="number">4</span> + a[i * <span class="number">8</span> + <span class="number">6</span>] * <span class="number">2</span> + a[i * <span class="number">8</span> + <span class="number">7</span>];</span><br><span class="line">		<span class="keyword">if</span> (add &gt;= <span class="number">10</span>)</span><br><span class="line">		{</span><br><span class="line">			<span class="keyword">switch</span> (add)</span><br><span class="line">			{</span><br><span class="line">			<span class="keyword">case</span> <span class="number">10</span>:<span class="built_in">printf</span>(<span class="string">"a"</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">11</span>:<span class="built_in">printf</span>(<span class="string">"b"</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">12</span>:<span class="built_in">printf</span>(<span class="string">"c"</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">13</span>:<span class="built_in">printf</span>(<span class="string">"d"</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">14</span>:<span class="built_in">printf</span>(<span class="string">"e"</span>); <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">15</span>:<span class="built_in">printf</span>(<span class="string">"f"</span>); <span class="keyword">break</span>;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d"</span>, add);</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 与函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">yu</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b,<span class="type">int</span> *temp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)  <span class="comment">//同为1为1，否则为0</span></span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">if</span> (a[i] == <span class="number">1</span> &amp;&amp; b[i] == <span class="number">1</span>)</span><br><span class="line">			temp[i] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			temp[i] = <span class="number">0</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 或函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">huo</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> *temp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)  <span class="comment">//同0为0，否则为1</span></span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">if</span> (a[i] == <span class="number">0</span> &amp;&amp; b[i] == <span class="number">0</span>)</span><br><span class="line">			temp[i] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			temp[i] = <span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 非函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fei</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *temp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)  </span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">if</span> (a[i] == <span class="number">0</span>)</span><br><span class="line">			temp[i] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			temp[i] = <span class="number">0</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*异或函数*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">yihuo</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> *temp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)  <span class="comment">//相同为0，不同为1</span></span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">if</span> (a[i] != b[i])</span><br><span class="line">			temp[i] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			temp[i] = <span class="number">0</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 模二的32次加 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">jia</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> *temp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i,jin;</span><br><span class="line">	jin = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">if</span> (a[<span class="number">31</span> - i] + b[<span class="number">31</span> - i] + jin&gt;<span class="number">1</span>)</span><br><span class="line">		{</span><br><span class="line">			temp[<span class="number">31</span> - i] = a[<span class="number">31</span> - i] + b[<span class="number">31</span> - i] + jin - <span class="number">2</span>;</span><br><span class="line">			jin = <span class="number">1</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		{</span><br><span class="line">			temp[<span class="number">31</span> - i] = a[<span class="number">31</span> - i] + b[<span class="number">31</span> - i]+jin;</span><br><span class="line">			jin = <span class="number">0</span>;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* F函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F</span><span class="params">(<span class="type">int</span> *b, <span class="type">int</span> *c, <span class="type">int</span> *d,<span class="type">int</span> *temp1,<span class="type">int</span> *temp2)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="comment">/* F(x,y,z)=(x∧y)∨(?x∧z) */</span></span><br><span class="line">	<span class="built_in">yu</span>(b, c, temp1);</span><br><span class="line">	<span class="built_in">fei</span>(b, temp2);</span><br><span class="line">	<span class="built_in">yu</span>(temp2, d, temp2);</span><br><span class="line">	<span class="built_in">huo</span>(temp1, temp2, temp2);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* G函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">G</span><span class="params">(<span class="type">int</span> *b, <span class="type">int</span> *c, <span class="type">int</span> *d, <span class="type">int</span> *temp1, <span class="type">int</span> *temp2)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="comment">/* G(x,y,z)=(x∧z)∨(y∧?z) */</span></span><br><span class="line">	<span class="built_in">yu</span>(b, d, temp1);</span><br><span class="line">	<span class="built_in">fei</span>(d, temp2);</span><br><span class="line">	<span class="built_in">yu</span>(temp2, c, temp2);</span><br><span class="line">	<span class="built_in">huo</span>(temp1, temp2, temp2);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* H函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">H</span><span class="params">(<span class="type">int</span> *b, <span class="type">int</span> *c, <span class="type">int</span> *d, <span class="type">int</span> *temp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="comment">/* H(x,y,z)=x⊕y⊕z */</span></span><br><span class="line">	<span class="built_in">yihuo</span>(b, c, temp);</span><br><span class="line">	<span class="built_in">yihuo</span>(temp, d, temp);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* I函数 */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">I</span><span class="params">(<span class="type">int</span> *b, <span class="type">int</span> *c, <span class="type">int</span> *d, <span class="type">int</span> *temp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="comment">/* I(x,y,z)=y⊕(x∨?z) */</span></span><br><span class="line">	<span class="built_in">fei</span>(d, temp);</span><br><span class="line">	<span class="built_in">huo</span>(b, temp, temp);</span><br><span class="line">	<span class="built_in">yihuo</span>(c, temp, temp);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*左移函数*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">move</span><span class="params">(<span class="type">int</span> step, <span class="type">int</span> *temp1, <span class="type">int</span> *temp2)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span> - step; i++)</span><br><span class="line">		temp2[i] = temp1[i + step];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; step; i++)</span><br><span class="line">		temp2[<span class="number">32</span> - step + i] = temp1[i];</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*每一大轮的16小轮循环函数*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">round</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> *c, <span class="type">int</span> *d, <span class="type">int</span> *m, <span class="type">int</span> *md5, <span class="type">int</span> r, <span class="type">char</span> *t1, </span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="type">char</span> *t2, <span class="type">char</span> *t3, <span class="type">char</span> *t4, <span class="type">char</span> *t5, <span class="type">char</span> *t6, <span class="type">char</span> *t7, <span class="type">char</span> *t8, <span class="type">char</span> *t9, </span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="type">char</span> *t10, <span class="type">char</span> *t11, <span class="type">char</span> *t12, <span class="type">char</span> *t13, <span class="type">char</span> *t14, <span class="type">char</span> *t15, <span class="type">char</span> *t16 )</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">int</span> i, j, in, step , temp1[<span class="number">32</span>], temp2[<span class="number">32</span>];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">switch</span> (r)  <span class="comment">//根据r判断所选的逻辑函数</span></span><br><span class="line">		{</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:<span class="built_in">F</span>(b, c, d, temp1, temp2); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:<span class="built_in">G</span>(b, c, d, temp1, temp2); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:<span class="built_in">H</span>(b, c, d, temp2); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:<span class="built_in">I</span>(b, c, d, temp2); <span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">		in = m[i];</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)</span><br><span class="line">			temp1[j] = md5[in * <span class="number">32</span> + j];</span><br><span class="line">		<span class="built_in">jia</span>(temp2, temp1, temp2);</span><br><span class="line">		<span class="keyword">switch</span> (i + <span class="number">1</span>)  <span class="comment">//选择t[]</span></span><br><span class="line">		{</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:<span class="built_in">shiliuzhuaner</span>(t1, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:<span class="built_in">shiliuzhuaner</span>(t2, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:<span class="built_in">shiliuzhuaner</span>(t3, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:<span class="built_in">shiliuzhuaner</span>(t4, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>:<span class="built_in">shiliuzhuaner</span>(t5, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>:<span class="built_in">shiliuzhuaner</span>(t6, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>:<span class="built_in">shiliuzhuaner</span>(t7, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">8</span>:<span class="built_in">shiliuzhuaner</span>(t8, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">9</span>:<span class="built_in">shiliuzhuaner</span>(t9, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">10</span>:<span class="built_in">shiliuzhuaner</span>(t10, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">11</span>:<span class="built_in">shiliuzhuaner</span>(t11, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">12</span>:<span class="built_in">shiliuzhuaner</span>(t12, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">13</span>:<span class="built_in">shiliuzhuaner</span>(t13, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">14</span>:<span class="built_in">shiliuzhuaner</span>(t14, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">15</span>:<span class="built_in">shiliuzhuaner</span>(t15, temp1); <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">16</span>:<span class="built_in">shiliuzhuaner</span>(t16, temp1); <span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="built_in">jia</span>(temp2, temp1, temp2);</span><br><span class="line">		<span class="built_in">jia</span>(temp2, a, temp2);</span><br><span class="line">		<span class="keyword">switch</span>(r)  <span class="comment">//根据r为左移步数step赋值</span></span><br><span class="line">		{  </span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">switch</span> (i % <span class="number">4</span> + <span class="number">1</span>){ <span class="keyword">case</span> <span class="number">1</span>:step = <span class="number">7</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">2</span>:step = <span class="number">12</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">3</span>:step = <span class="number">17</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">4</span>:step = <span class="number">22</span>; <span class="keyword">break</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:<span class="keyword">switch</span> (i % <span class="number">4</span> + <span class="number">1</span>){ <span class="keyword">case</span> <span class="number">1</span>:step = <span class="number">5</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">2</span>:step = <span class="number">9</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">3</span>:step = <span class="number">14</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">4</span>:step = <span class="number">20</span>; <span class="keyword">break</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">switch</span> (i % <span class="number">4</span> + <span class="number">1</span>){ <span class="keyword">case</span> <span class="number">1</span>:step = <span class="number">4</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">2</span>:step = <span class="number">11</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">3</span>:step = <span class="number">16</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">4</span>:step = <span class="number">23</span>; <span class="keyword">break</span>; }<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:<span class="keyword">switch</span> (i % <span class="number">4</span> + <span class="number">1</span>){ <span class="keyword">case</span> <span class="number">1</span>:step = <span class="number">6</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">2</span>:step = <span class="number">10</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">3</span>:step = <span class="number">15</span>; <span class="keyword">break</span>; <span class="keyword">case</span> <span class="number">4</span>:step = <span class="number">21</span>; <span class="keyword">break</span>; }<span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="built_in">move</span>(step, temp2, temp1);</span><br><span class="line">		<span class="built_in">jia</span>(temp1, b, temp2);</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)</span><br><span class="line">		{</span><br><span class="line">			a[j] = d[j];</span><br><span class="line">			d[j] = c[j];</span><br><span class="line">			c[j] = b[j];</span><br><span class="line">			b[j] = temp2[j];</span><br><span class="line">		}</span><br><span class="line"> </span><br><span class="line">		<span class="comment">/*若想输出每轮a、b、c、d的值，把下面的注释取消即可*/</span></span><br><span class="line">		<span class="comment">/*printf("第%d大轮的第%d小轮\n", r, i);</span></span><br><span class="line"><span class="comment">		abcd_out(a);</span></span><br><span class="line"><span class="comment">		printf("   ");</span></span><br><span class="line"><span class="comment">		abcd_out(b);</span></span><br><span class="line"><span class="comment">		printf("   ");</span></span><br><span class="line"><span class="comment">		abcd_out(c);</span></span><br><span class="line"><span class="comment">		printf("   ");</span></span><br><span class="line"><span class="comment">		abcd_out(d);</span></span><br><span class="line"><span class="comment">		printf("\n");*/</span></span><br><span class="line"> </span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 主函数 */</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">char</span> ch,</span><br><span class="line">		<span class="comment">/* 一大坨t[] */</span></span><br><span class="line">		t1[<span class="number">8</span>] = { <span class="string">'d'</span>, <span class="string">'7'</span>, <span class="string">'6'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'4'</span>, <span class="string">'7'</span>, <span class="string">'8'</span> },</span><br><span class="line">		t2[<span class="number">8</span>] = { <span class="string">'e'</span>, <span class="string">'8'</span>, <span class="string">'c'</span>, <span class="string">'7'</span>, <span class="string">'b'</span>, <span class="string">'7'</span>, <span class="string">'5'</span>, <span class="string">'6'</span> },</span><br><span class="line">		t3[<span class="number">8</span>] = { <span class="string">'2'</span>, <span class="string">'4'</span>, <span class="string">'2'</span>, <span class="string">'0'</span>, <span class="string">'7'</span>, <span class="string">'0'</span>, <span class="string">'d'</span>, <span class="string">'b'</span> },</span><br><span class="line">		t4[<span class="number">8</span>] = { <span class="string">'c'</span>, <span class="string">'1'</span>, <span class="string">'b'</span>, <span class="string">'d'</span>, <span class="string">'c'</span>, <span class="string">'e'</span>, <span class="string">'e'</span>, <span class="string">'e'</span> },</span><br><span class="line">		t5[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'5'</span>, <span class="string">'7'</span>, <span class="string">'c'</span>, <span class="string">'0'</span>, <span class="string">'f'</span>, <span class="string">'a'</span>, <span class="string">'f'</span> },</span><br><span class="line">		t6[<span class="number">8</span>] = { <span class="string">'4'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'7'</span>, <span class="string">'c'</span>, <span class="string">'6'</span>, <span class="string">'2'</span>, <span class="string">'a'</span> },</span><br><span class="line">		t7[<span class="number">8</span>] = { <span class="string">'a'</span>, <span class="string">'8'</span>, <span class="string">'3'</span>, <span class="string">'0'</span>, <span class="string">'4'</span>, <span class="string">'6'</span>, <span class="string">'1'</span>, <span class="string">'3'</span> },</span><br><span class="line">		t8[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'d'</span>, <span class="string">'4'</span>, <span class="string">'6'</span>, <span class="string">'9'</span>, <span class="string">'5'</span>, <span class="string">'0'</span>, <span class="string">'1'</span> },</span><br><span class="line">		t9[<span class="number">8</span>] = { <span class="string">'6'</span>, <span class="string">'9'</span>, <span class="string">'8'</span>, <span class="string">'0'</span>, <span class="string">'9'</span>, <span class="string">'8'</span>, <span class="string">'d'</span>, <span class="string">'8'</span> },</span><br><span class="line">		t10[<span class="number">8</span>] = { <span class="string">'8'</span>, <span class="string">'b'</span>, <span class="string">'4'</span>, <span class="string">'4'</span>, <span class="string">'f'</span>, <span class="string">'7'</span>, <span class="string">'a'</span>, <span class="string">'f'</span> },</span><br><span class="line">		t11[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'f'</span>, <span class="string">'f'</span>, <span class="string">'f'</span>, <span class="string">'5'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'1'</span> },</span><br><span class="line">		t12[<span class="number">8</span>] = { <span class="string">'8'</span>, <span class="string">'9'</span>, <span class="string">'5'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'7'</span>, <span class="string">'b'</span>, <span class="string">'e'</span> },</span><br><span class="line">		t13[<span class="number">8</span>] = { <span class="string">'6'</span>, <span class="string">'b'</span>, <span class="string">'9'</span>, <span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'2'</span> },</span><br><span class="line">		t14[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'d'</span>, <span class="string">'9'</span>, <span class="string">'8'</span>, <span class="string">'7'</span>, <span class="string">'1'</span>, <span class="string">'9'</span>, <span class="string">'3'</span> },</span><br><span class="line">		t15[<span class="number">8</span>] = { <span class="string">'a'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'9'</span>, <span class="string">'4'</span>, <span class="string">'3'</span>, <span class="string">'8'</span>, <span class="string">'e'</span> },</span><br><span class="line">		t16[<span class="number">8</span>] = { <span class="string">'4'</span>, <span class="string">'9'</span>, <span class="string">'b'</span>, <span class="string">'4'</span>, <span class="string">'0'</span>, <span class="string">'8'</span>, <span class="string">'2'</span>, <span class="string">'1'</span> },</span><br><span class="line">		t17[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'6'</span>, <span class="string">'1'</span>, <span class="string">'e'</span>, <span class="string">'2'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'2'</span> },</span><br><span class="line">		t18[<span class="number">8</span>] = { <span class="string">'c'</span>, <span class="string">'0'</span>, <span class="string">'4'</span>, <span class="string">'0'</span>, <span class="string">'b'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'0'</span> },</span><br><span class="line">		t19[<span class="number">8</span>] = { <span class="string">'2'</span>, <span class="string">'6'</span>, <span class="string">'5'</span>, <span class="string">'e'</span>, <span class="string">'5'</span>, <span class="string">'a'</span>, <span class="string">'5'</span>, <span class="string">'1'</span> },</span><br><span class="line">		t20[<span class="number">8</span>] = { <span class="string">'e'</span>, <span class="string">'9'</span>, <span class="string">'b'</span>, <span class="string">'6'</span>, <span class="string">'c'</span>, <span class="string">'7'</span>, <span class="string">'a'</span>, <span class="string">'a'</span> },</span><br><span class="line">		t21[<span class="number">8</span>] = { <span class="string">'d'</span>, <span class="string">'6'</span>, <span class="string">'2'</span>, <span class="string">'f'</span>, <span class="string">'1'</span>, <span class="string">'0'</span>, <span class="string">'5'</span>, <span class="string">'d'</span> },</span><br><span class="line">		t22[<span class="number">8</span>] = { <span class="string">'0'</span>, <span class="string">'2'</span>, <span class="string">'4'</span>, <span class="string">'4'</span>, <span class="string">'1'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'3'</span> },</span><br><span class="line">		t23[<span class="number">8</span>] = { <span class="string">'d'</span>, <span class="string">'8'</span>, <span class="string">'a'</span>, <span class="string">'1'</span>, <span class="string">'e'</span>, <span class="string">'6'</span>, <span class="string">'8'</span>, <span class="string">'1'</span> },</span><br><span class="line">		t24[<span class="number">8</span>] = { <span class="string">'e'</span>, <span class="string">'7'</span>, <span class="string">'d'</span>, <span class="string">'3'</span>, <span class="string">'f'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'8'</span> },</span><br><span class="line">		t25[<span class="number">8</span>] = { <span class="string">'2'</span>, <span class="string">'1'</span>, <span class="string">'e'</span>, <span class="string">'1'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'6'</span> },</span><br><span class="line">		t26[<span class="number">8</span>] = { <span class="string">'c'</span>, <span class="string">'3'</span>, <span class="string">'3'</span>, <span class="string">'7'</span>, <span class="string">'0'</span>, <span class="string">'7'</span>, <span class="string">'d'</span>, <span class="string">'6'</span> },</span><br><span class="line">		t27[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'4'</span>, <span class="string">'d'</span>, <span class="string">'5'</span>, <span class="string">'0'</span>, <span class="string">'d'</span>, <span class="string">'8'</span>, <span class="string">'7'</span> },</span><br><span class="line">		t28[<span class="number">8</span>] = { <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'5'</span>, <span class="string">'a'</span>, <span class="string">'1'</span>, <span class="string">'4'</span>, <span class="string">'e'</span>, <span class="string">'d'</span> },</span><br><span class="line">		t29[<span class="number">8</span>] = { <span class="string">'a'</span>, <span class="string">'9'</span>, <span class="string">'e'</span>, <span class="string">'3'</span>, <span class="string">'e'</span>, <span class="string">'9'</span>, <span class="string">'0'</span>, <span class="string">'5'</span> },</span><br><span class="line">		t30[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'c'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'a'</span>, <span class="string">'3'</span>, <span class="string">'f'</span>, <span class="string">'8'</span> },</span><br><span class="line">		t31[<span class="number">8</span>] = { <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'6'</span>, <span class="string">'f'</span>, <span class="string">'0'</span>, <span class="string">'2'</span>, <span class="string">'d'</span>, <span class="string">'9'</span> },</span><br><span class="line">		t32[<span class="number">8</span>] = { <span class="string">'8'</span>, <span class="string">'d'</span>, <span class="string">'2'</span>, <span class="string">'a'</span>, <span class="string">'4'</span>, <span class="string">'c'</span>, <span class="string">'8'</span>, <span class="string">'a'</span> },</span><br><span class="line">		t33[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'f'</span>, <span class="string">'f'</span>, <span class="string">'a'</span>, <span class="string">'3'</span>, <span class="string">'9'</span>, <span class="string">'4'</span>, <span class="string">'2'</span> },</span><br><span class="line">		t34[<span class="number">8</span>] = { <span class="string">'8'</span>, <span class="string">'7'</span>, <span class="string">'7'</span>, <span class="string">'1'</span>, <span class="string">'f'</span>, <span class="string">'6'</span>, <span class="string">'8'</span>, <span class="string">'1'</span> },</span><br><span class="line">		t35[<span class="number">8</span>] = { <span class="string">'6'</span>, <span class="string">'d'</span>, <span class="string">'9'</span>, <span class="string">'d'</span>, <span class="string">'6'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'2'</span> },</span><br><span class="line">		t36[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'5'</span>, <span class="string">'3'</span>, <span class="string">'8'</span>, <span class="string">'0'</span>, <span class="string">'c'</span> },</span><br><span class="line">		t37[<span class="number">8</span>] = { <span class="string">'a'</span>, <span class="string">'4'</span>, <span class="string">'b'</span>, <span class="string">'e'</span>, <span class="string">'e'</span>, <span class="string">'a'</span>, <span class="string">'4'</span>, <span class="string">'4'</span> },</span><br><span class="line">		t38[<span class="number">8</span>] = { <span class="string">'4'</span>, <span class="string">'b'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'c'</span>, <span class="string">'f'</span>, <span class="string">'a'</span>, <span class="string">'9'</span> },</span><br><span class="line">		t39[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'6'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'4'</span>, <span class="string">'b'</span>, <span class="string">'6'</span>, <span class="string">'0'</span> },</span><br><span class="line">		t40[<span class="number">8</span>] = { <span class="string">'b'</span>, <span class="string">'e'</span>, <span class="string">'b'</span>, <span class="string">'f'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'7'</span>, <span class="string">'0'</span> },</span><br><span class="line">		t41[<span class="number">8</span>] = { <span class="string">'2'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>, <span class="string">'b'</span>, <span class="string">'7'</span>, <span class="string">'e'</span>, <span class="string">'c'</span>, <span class="string">'6'</span> },</span><br><span class="line">		t42[<span class="number">8</span>] = { <span class="string">'e'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'7'</span>, <span class="string">'f'</span>, <span class="string">'a'</span> },</span><br><span class="line">		t43[<span class="number">8</span>] = { <span class="string">'d'</span>, <span class="string">'4'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'3'</span>, <span class="string">'0'</span>, <span class="string">'8'</span>, <span class="string">'5'</span> },</span><br><span class="line">		t44[<span class="number">8</span>] = { <span class="string">'0'</span>, <span class="string">'4'</span>, <span class="string">'8'</span>, <span class="string">'8'</span>, <span class="string">'1'</span>, <span class="string">'d'</span>, <span class="string">'0'</span>, <span class="string">'5'</span> },</span><br><span class="line">		t45[<span class="number">8</span>] = { <span class="string">'d'</span>, <span class="string">'9'</span>, <span class="string">'d'</span>, <span class="string">'4'</span>, <span class="string">'d'</span>, <span class="string">'0'</span>, <span class="string">'3'</span>, <span class="string">'9'</span> },</span><br><span class="line">		t46[<span class="number">8</span>] = { <span class="string">'e'</span>, <span class="string">'6'</span>, <span class="string">'d'</span>, <span class="string">'b'</span>, <span class="string">'9'</span>, <span class="string">'9'</span>, <span class="string">'e'</span>, <span class="string">'5'</span> },</span><br><span class="line">		t47[<span class="number">8</span>] = { <span class="string">'1'</span>, <span class="string">'f'</span>, <span class="string">'a'</span>, <span class="string">'2'</span>, <span class="string">'7'</span>, <span class="string">'c'</span>, <span class="string">'f'</span>, <span class="string">'8'</span> },</span><br><span class="line">		t48[<span class="number">8</span>] = { <span class="string">'c'</span>, <span class="string">'4'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'6'</span>, <span class="string">'5'</span> },</span><br><span class="line">		t49[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'4'</span>, <span class="string">'2'</span>, <span class="string">'9'</span>, <span class="string">'2'</span>, <span class="string">'2'</span>, <span class="string">'4'</span>, <span class="string">'4'</span> },</span><br><span class="line">		t50[<span class="number">8</span>] = { <span class="string">'4'</span>, <span class="string">'3'</span>, <span class="string">'2'</span>, <span class="string">'a'</span>, <span class="string">'f'</span>, <span class="string">'f'</span>, <span class="string">'9'</span>, <span class="string">'7'</span> },</span><br><span class="line">		t51[<span class="number">8</span>] = { <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'9'</span>, <span class="string">'4'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'a'</span>, <span class="string">'7'</span> },</span><br><span class="line">		t52[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'c'</span>, <span class="string">'9'</span>, <span class="string">'3'</span>, <span class="string">'a'</span>, <span class="string">'0'</span>, <span class="string">'3'</span>, <span class="string">'9'</span> },</span><br><span class="line">		t53[<span class="number">8</span>] = { <span class="string">'6'</span>, <span class="string">'5'</span>, <span class="string">'5'</span>, <span class="string">'b'</span>, <span class="string">'5'</span>, <span class="string">'9'</span>, <span class="string">'c'</span>, <span class="string">'3'</span> },</span><br><span class="line">		t54[<span class="number">8</span>] = { <span class="string">'8'</span>, <span class="string">'f'</span>, <span class="string">'0'</span>, <span class="string">'c'</span>, <span class="string">'c'</span>, <span class="string">'c'</span>, <span class="string">'9'</span>, <span class="string">'2'</span> },</span><br><span class="line">		t55[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'f'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'f'</span>, <span class="string">'4'</span>, <span class="string">'7'</span>, <span class="string">'d'</span> },</span><br><span class="line">		t56[<span class="number">8</span>] = { <span class="string">'8'</span>, <span class="string">'5'</span>, <span class="string">'8'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'d'</span>, <span class="string">'d'</span>, <span class="string">'1'</span> },</span><br><span class="line">		t57[<span class="number">8</span>] = { <span class="string">'6'</span>, <span class="string">'f'</span>, <span class="string">'a'</span>, <span class="string">'8'</span>, <span class="string">'7'</span>, <span class="string">'e'</span>, <span class="string">'4'</span>, <span class="string">'f'</span> },</span><br><span class="line">		t58[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'e'</span>, <span class="string">'2'</span>, <span class="string">'c'</span>, <span class="string">'e'</span>, <span class="string">'6'</span>, <span class="string">'e'</span>, <span class="string">'0'</span> },</span><br><span class="line">		t59[<span class="number">8</span>] = { <span class="string">'a'</span>, <span class="string">'3'</span>, <span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'4'</span>, <span class="string">'3'</span>, <span class="string">'1'</span>, <span class="string">'4'</span> },</span><br><span class="line">		t60[<span class="number">8</span>] = { <span class="string">'4'</span>, <span class="string">'e'</span>, <span class="string">'0'</span>, <span class="string">'8'</span>, <span class="string">'1'</span>, <span class="string">'1'</span>, <span class="string">'a'</span>, <span class="string">'1'</span> },</span><br><span class="line">		t61[<span class="number">8</span>] = { <span class="string">'f'</span>, <span class="string">'7'</span>, <span class="string">'5'</span>, <span class="string">'3'</span>, <span class="string">'7'</span>, <span class="string">'e'</span>, <span class="string">'8'</span>, <span class="string">'2'</span> },</span><br><span class="line">		t62[<span class="number">8</span>] = { <span class="string">'b'</span>, <span class="string">'d'</span>, <span class="string">'3'</span>, <span class="string">'a'</span>, <span class="string">'f'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'5'</span> },</span><br><span class="line">		t63[<span class="number">8</span>] = { <span class="string">'2'</span>, <span class="string">'a'</span>, <span class="string">'d'</span>, <span class="string">'7'</span>, <span class="string">'d'</span>, <span class="string">'2'</span>, <span class="string">'b'</span>, <span class="string">'b'</span> },</span><br><span class="line">		t64[<span class="number">8</span>] = { <span class="string">'e'</span>, <span class="string">'b'</span>, <span class="string">'8'</span>, <span class="string">'6'</span>, <span class="string">'d'</span>, <span class="string">'3'</span>, <span class="string">'9'</span>, <span class="string">'1'</span> };</span><br><span class="line">	<span class="type">int</span> in, n = <span class="number">0</span>, i,j,addup;</span><br><span class="line">	<span class="type">int</span> md5[<span class="number">512</span>],</span><br><span class="line">		<span class="comment">/*每一大轮m[]的调用顺序*/</span></span><br><span class="line">		m1[<span class="number">16</span>] = { <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span> },</span><br><span class="line">		m2[<span class="number">16</span>] = { <span class="number">1</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span> },</span><br><span class="line">		m3[<span class="number">16</span>] = { <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">2</span> },</span><br><span class="line">		m4[<span class="number">16</span>] = { <span class="number">0</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">9</span> },</span><br><span class="line">		<span class="comment">/* a[]、b[]、c[]、d[]的初始值(已经过大小端处理) */</span></span><br><span class="line">		<span class="comment">/* 把a[]、b[]、c[]、d[]赋值给a1[]、b1[]、c1[]、d1[]*/</span></span><br><span class="line">		a[<span class="number">32</span>] = { <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> },</span><br><span class="line">		a1[<span class="number">32</span>] = { <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> },</span><br><span class="line">		b[<span class="number">32</span>] = { <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> },</span><br><span class="line">		b1[<span class="number">32</span>] = { <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> },</span><br><span class="line">		c[<span class="number">32</span>] = { <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span> },</span><br><span class="line">		c1[<span class="number">32</span>] = { <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span> },</span><br><span class="line">		d[<span class="number">32</span>] = { <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span> },</span><br><span class="line">		d1[<span class="number">32</span>] = { <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">		<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span> };</span><br><span class="line"><span class="comment">//	printf("请输入需加密的明文（长度不大于56)\n");</span></span><br><span class="line"><span class="comment">//	ch = getchar();</span></span><br><span class="line"><span class="comment">//	while (ch!='\n'&amp;&amp;n&lt;57)  //用getchar()函数接收字符，直到接收到回车符或字符数超过56为止</span></span><br><span class="line"><span class="comment">//	{</span></span><br><span class="line"><span class="comment">//		in = (int)ch;</span></span><br><span class="line"><span class="comment">//		shizhuaner(in, n, md5);</span></span><br><span class="line"><span class="comment">//		n++;</span></span><br><span class="line"><span class="comment">//		ch = getchar();</span></span><br><span class="line"><span class="comment">//	}</span></span><br><span class="line">	FILE *fp1,*fp2;</span><br><span class="line">    fp1 = <span class="built_in">fopen</span>(<span class="string">"text.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">    fp2 = <span class="built_in">fopen</span>(<span class="string">"c.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">fscanf</span>(fp1,<span class="string">"%c"</span>,&amp;ch)!=EOF)</span><br><span class="line">    {</span><br><span class="line"><span class="comment">//        if(islower(ch))</span></span><br><span class="line"><span class="comment">//            c[i] = toupper(ch);</span></span><br><span class="line"><span class="comment">//        else</span></span><br><span class="line"><span class="comment">//            c[i] = ch;</span></span><br><span class="line"><span class="comment">//        i++;</span></span><br><span class="line">          in = (<span class="type">int</span>)ch;</span><br><span class="line">          <span class="built_in">shizhuaner</span>(in,n,md5);</span><br><span class="line">          n++;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">	i = <span class="number">0</span>;</span><br><span class="line">	addup = n;</span><br><span class="line">	<span class="keyword">while</span> (n% <span class="number">4</span> != <span class="number">0</span> &amp;&amp; n&lt;<span class="number">56</span>)  <span class="comment">//长度不是4的倍数，补一个1和0直到长度为4的倍数,，最终实现用1与0使其长度模512与448同于，在这个程序里也就是448</span></span><br><span class="line">	{</span><br><span class="line">		<span class="type">int</span> s, w, j;</span><br><span class="line">		s = n / <span class="number">4</span> + <span class="number">1</span>;</span><br><span class="line">		w = n % <span class="number">4</span>;</span><br><span class="line">		j = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		{</span><br><span class="line">			md5[<span class="number">32</span> * s - <span class="number">8</span> * w - j] = <span class="number">0</span>;</span><br><span class="line">			j++;</span><br><span class="line">		} <span class="keyword">while</span> (j&lt;=<span class="number">7</span>);</span><br><span class="line">		<span class="keyword">if</span> (i == <span class="number">0</span>)</span><br><span class="line">		{</span><br><span class="line">			md5[<span class="number">32</span> * s - <span class="number">8</span> * w - j] = <span class="number">1</span>;  </span><br><span class="line">			i = <span class="number">1</span>;</span><br><span class="line">		}</span><br><span class="line">		n++;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span> (i == <span class="number">0</span>)  <span class="comment">//长度不是4的倍数，补一个1和31个0</span></span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)</span><br><span class="line">			md5[n * <span class="number">8</span> + j] = <span class="number">0</span>;</span><br><span class="line">		md5[<span class="number">8</span> * n + <span class="number">24</span>] = <span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">512</span>; i++)  <span class="comment">//补零，任何不为1的数都设为0</span></span><br><span class="line">	{</span><br><span class="line">		<span class="keyword">if</span> (md5[i] == <span class="number">1</span>)</span><br><span class="line">			md5[i] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			md5[i] = <span class="number">0</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="built_in">shizhuaner_weishu</span>(addup * <span class="number">8</span>, md5);  <span class="comment">//64位数填充</span></span><br><span class="line"> </span><br><span class="line">	<span class="comment">/*若想看m[0]~m[15],把下面注释去掉即可*/</span></span><br><span class="line">	<span class="comment">/*printf("m[0]~m[15]如下:\n");</span></span><br><span class="line"><span class="comment">	for (i = 0; i &lt; 512; i++)</span></span><br><span class="line"><span class="comment">	{</span></span><br><span class="line"><span class="comment">		printf("%d ", md5[i]);</span></span><br><span class="line"><span class="comment">		if (i % 8 == 7)</span></span><br><span class="line"><span class="comment">			printf("\n");</span></span><br><span class="line"><span class="comment">		if (i % 32 == 31)</span></span><br><span class="line"><span class="comment">			printf("\n");</span></span><br><span class="line"><span class="comment">	}</span></span><br><span class="line"><span class="comment">	printf("\n");*/</span></span><br><span class="line"> </span><br><span class="line">	<span class="comment">/* 第一、二、三、四大轮，每一大轮下有16小轮 */</span></span><br><span class="line">	<span class="built_in">round</span>(a, b, c, d, m1, md5, <span class="number">1</span>, t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14, t15, t16);</span><br><span class="line">	<span class="built_in">round</span>(a, b, c, d, m2, md5, <span class="number">2</span>, t17, t18, t19, t20, t21, t22, t23, t24, t25, t26, t27, t28, t29, t30, t31, t32);</span><br><span class="line">	<span class="built_in">round</span>(a, b, c, d, m3, md5, <span class="number">3</span>, t33, t34, t35, t36, t37, t38, t39, t40, t41, t42, t43, t44, t45, t46, t47, t48);</span><br><span class="line">	<span class="built_in">round</span>(a, b, c, d, m4, md5, <span class="number">4</span>, t49, t50, t51, t52, t53, t54, t55, t56, t57, t58, t59, t60, t61, t62, t63, t64);</span><br><span class="line">	<span class="comment">//printf("\n");</span></span><br><span class="line">	<span class="comment">/* 最终的a、b、c、d分别与最初的a、b、c、d相加 */</span></span><br><span class="line">	<span class="built_in">jia</span>(a, a1, a);</span><br><span class="line">	<span class="built_in">jia</span>(b, b1, b);</span><br><span class="line">	<span class="built_in">jia</span>(c, c1, c);</span><br><span class="line">	<span class="built_in">jia</span>(d, d1, d);</span><br><span class="line">	<span class="comment">/*密文输出*/</span></span><br><span class="line">	<span class="comment">//printf("密文:\n");</span></span><br><span class="line">	<span class="built_in">c_out</span>(a);</span><br><span class="line">	<span class="built_in">c_out</span>(b);</span><br><span class="line">	<span class="built_in">c_out</span>(c);</span><br><span class="line">	<span class="built_in">c_out</span>(d);</span><br><span class="line">	<span class="comment">//printf("\n");</span></span><br><span class="line">	<span class="comment">//printf("%d",o);</span></span><br><span class="line">	<span class="built_in">fprintf</span>(fp2,out);</span><br><span class="line">	<span class="comment">//fputs(out,fp2);</span></span><br><span class="line">    <span class="built_in">fclose</span>(fp1);</span><br><span class="line">    <span class="built_in">fclose</span>(fp2);</span><br><span class="line"><span class="comment">//	fputs(char(a),fp2);</span></span><br><span class="line"><span class="comment">//	fputs(char(b),fp2);</span></span><br><span class="line"><span class="comment">//	fputs(char(c),fp2);</span></span><br><span class="line"><span class="comment">//	fputs(char(d),fp2);</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/19/Crypto-lab/Crypto-lab/image-20230519160559743.png" alt="image-20230519160559743"></p>
<h2 id="密码应用-文件安全传输"><a href="#密码应用-文件安全传输" class="headerlink" title="密码应用 文件安全传输"></a>密码应用 文件安全传输</h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://nexuslbh.top">NexusLbh</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://nexuslbh.top/2023/05/19/Crypto-lab/">http://nexuslbh.top/2023/05/19/Crypto-lab/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://nexuslbh.top" target="_blank">Meta Field</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SEC/">SEC</a></div><div class="post_share"><div class="social-share" data-image="/img/tree.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/04/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%9A%90%E7%A7%81%E4%BF%9D%E6%8A%A4%E9%99%84%E5%8A%A0%E5%AE%9E%E9%AA%8C/" title="大数据隐私保护附加实验"><img class="cover" src="/img/niaokan.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">大数据隐私保护附加实验</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/03/04/CS-SEC-%E6%9C%9F%E6%9C%AB%E7%9F%A5%E8%AF%86%E7%82%B9/" title="CS-SEC 期末知识点"><img class="cover" src="/img/men.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-04</div><div class="title">CS-SEC 期末知识点</div></div></a></div><div><a href="/2023/03/22/Crypto-Homework/" title="Crypto_Homework"><img class="cover" src="/img/tree.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-22</div><div class="title">Crypto_Homework</div></div></a></div><div><a href="/2022/11/05/DES/" title="DES"><img class="cover" src="/img/tree.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-05</div><div class="title">DES</div></div></a></div><div><a href="/2022/07/22/MIT-CS6-858-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/" title="MIT-CS6.858-计算机系统安全"><img class="cover" src="https://w.wallhaven.cc/full/jx/wallhaven-jx3l2y.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-22</div><div class="title">MIT-CS6.858-计算机系统安全</div></div></a></div><div><a href="/2023/01/17/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81-%E6%A0%BC%E5%AF%86%E7%A0%81%E5%AD%A6/" title="后量子密码-格密码学"><img class="cover" src="/img/cloud.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-17</div><div class="title">后量子密码-格密码学</div></div></a></div><div><a href="/2023/02/07/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%9A%90%E7%A7%81%E4%BF%9D%E6%8A%A4%E5%AE%9E%E9%AA%8C%E4%B8%80/" title="大数据隐私保护实验一"><img class="cover" src="/img/moon.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-07</div><div class="title">大数据隐私保护实验一</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">NexusLbh</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">67</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/NexusXDlbh"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/NexusXDlbh" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:3321861647@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text"> </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">古典密码算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Caser"><span class="toc-number">2.1.</span> <span class="toc-text">Caser</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E7%BD%AE%E6%8D%A2"><span class="toc-number">2.2.</span> <span class="toc-text">单表置换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BF%E5%B0%84"><span class="toc-number">2.3.</span> <span class="toc-text">仿射</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B1%82%E9%80%86%E5%85%83"><span class="toc-number">2.3.1.</span> <span class="toc-text">求逆元</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0"><span class="toc-number">2.3.2.</span> <span class="toc-text">最大公约数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B4%A0%E6%80%A7%E5%88%A4%E6%96%AD"><span class="toc-number">2.3.3.</span> <span class="toc-text">素性判断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86"><span class="toc-number">2.3.4.</span> <span class="toc-text">加密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86"><span class="toc-number">2.3.5.</span> <span class="toc-text">解密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#main%E5%87%BD%E6%95%B0"><span class="toc-number">2.3.6.</span> <span class="toc-text">main函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81"><span class="toc-number">3.</span> <span class="toc-text">对称密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DES"><span class="toc-number">3.1.</span> <span class="toc-text">DES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AES"><span class="toc-number">3.2.</span> <span class="toc-text">AES</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81-RSA"><span class="toc-number">4.</span> <span class="toc-text">非对称密码 RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hash-MD5"><span class="toc-number">5.</span> <span class="toc-text">Hash MD5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%BA%94%E7%94%A8-%E6%96%87%E4%BB%B6%E5%AE%89%E5%85%A8%E4%BC%A0%E8%BE%93"><span class="toc-number">6.</span> <span class="toc-text">密码应用 文件安全传输</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/05/19/Crypto-lab/" title="Crypto_lab"><img src="/img/tree.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Crypto_lab"/></a><div class="content"><a class="title" href="/2023/05/19/Crypto-lab/" title="Crypto_lab">Crypto_lab</a><time datetime="2023-05-19T08:18:07.270Z" title="更新于 2023-05-19 16:18:07">2023-05-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/05/DES/" title="DES"><img src="/img/tree.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DES"/></a><div class="content"><a class="title" href="/2022/11/05/DES/" title="DES">DES</a><time datetime="2023-05-19T07:48:14.964Z" title="更新于 2023-05-19 15:48:14">2023-05-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/01/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%9A%90%E7%A7%81%E4%BF%9D%E6%8A%A4%E5%AE%9E%E9%AA%8C%E4%B8%89/" title="大数据隐私保护实验三"><img src="/img/tree.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="大数据隐私保护实验三"/></a><div class="content"><a class="title" href="/2023/03/01/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%9A%90%E7%A7%81%E4%BF%9D%E6%8A%A4%E5%AE%9E%E9%AA%8C%E4%B8%89/" title="大数据隐私保护实验三">大数据隐私保护实验三</a><time datetime="2023-05-11T11:01:11.771Z" title="更新于 2023-05-11 19:01:11">2023-05-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%9A%90%E7%A7%81%E4%BF%9D%E6%8A%A4%E9%99%84%E5%8A%A0%E5%AE%9E%E9%AA%8C/" title="大数据隐私保护附加实验"><img src="/img/niaokan.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="大数据隐私保护附加实验"/></a><div class="content"><a class="title" href="/2023/04/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%9A%90%E7%A7%81%E4%BF%9D%E6%8A%A4%E9%99%84%E5%8A%A0%E5%AE%9E%E9%AA%8C/" title="大数据隐私保护附加实验">大数据隐私保护附加实验</a><time datetime="2023-04-17T13:13:35.563Z" title="更新于 2023-04-17 21:13:35">2023-04-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/03/chatgpt-academic/" title="chatgpt_academic"><img src="/img/tree.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="chatgpt_academic"/></a><div class="content"><a class="title" href="/2023/04/03/chatgpt-academic/" title="chatgpt_academic">chatgpt_academic</a><time datetime="2023-04-07T03:54:49.444Z" title="更新于 2023-04-07 11:54:49">2023-04-07</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/tree.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By NexusLbh</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>