<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>KNN | Meta Field</title><meta name="author" content="NexusLbh"><meta name="copyright" content="NexusLbh"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="These are the nights that never die!">
<meta property="og:type" content="article">
<meta property="og:title" content="KNN">
<meta property="og:url" content="http://nexuslbh.top/2022/08/26/KNN/index.html">
<meta property="og:site_name" content="Meta Field">
<meta property="og:description" content="These are the nights that never die!">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://nexuslbh.top/img/tq.jpg">
<meta property="article:published_time" content="2022-08-26T03:18:23.000Z">
<meta property="article:modified_time" content="2023-03-25T05:46:29.624Z">
<meta property="article:author" content="NexusLbh">
<meta property="article:tag" content="ML">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://nexuslbh.top/img/tq.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://nexuslbh.top/2022/08/26/KNN/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'KNN',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-25 13:46:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/font.css"><meta name="generator" content="Hexo 5.4.2"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">63</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/tq.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Meta Field"><span class="site-name">Meta Field</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">KNN</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-26T03:18:23.000Z" title="发表于 2022-08-26 11:18:23">2022-08-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-25T05:46:29.624Z" title="更新于 2023-03-25 13:46:29">2023-03-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MachineLearning/">MachineLearning</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="KNN"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>These are the nights that never die!</p>
<span id="more"></span>
<h2 id="Introduction-to-K-Nearest-Neighbors-Classifier"><a href="#Introduction-to-K-Nearest-Neighbors-Classifier" class="headerlink" title="Introduction to K-Nearest Neighbors Classifier"></a>Introduction to K-Nearest Neighbors Classifier</h2><p>KNN is a very easy algorithm.</p>
<p>kNN classifier is to classify <strong>unlabeled observations</strong> by assigning them to the class of the most similar labeled examples. Characteristics of observations are collected for both training and test dataset. For example, fruit, vegetable and grain can be distinguished by their crunchiness and sweetness.</p>
<p><img src="/2022/08/26/KNN/k1.png" alt></p>
<p>There are two important concepts in the above example.</p>
<h3 id="1-Distance"><a href="#1-Distance" class="headerlink" title="1.Distance"></a>1.Distance</h3><p><strong>Minkowski Distance</strong></p>
<p>In fact, it`s not a sort of distance, but a defination of distance.</p>
<script type="math/tex; mode=display">
d_{xy} = \sqrt[q]{\sum_{k=1}^{n}(x_k-y_k)^p}</script><p>where p is a variable parameter</p>
<p>if p = 1 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewbox="0 -511 1000 522"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"/></g></g></g></svg></mjx-container> Manhattan Distance</p>
<script type="math/tex; mode=display">
D = \sum_{k=1}^{n}{|x_k-y_k|}</script><p>if p = 2 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewbox="0 -511 1000 522"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"/></g></g></g></svg></mjx-container> Euclidean Distance</p>
<p>if p = <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 1000 453"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"/></g></g></g></svg></mjx-container> <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewbox="0 -511 1000 522"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"/></g></g></g></svg></mjx-container>  Chebyshev Distance</p>
<script type="math/tex; mode=display">
D = max|x_i-y_i|,1\leq i \leq n</script><p><strong>Euclidean distance</strong></p>
<p> By default, the knn() function employs <strong>Euclidean distance</strong> which can be calculated with the following equation</p>
<script type="math/tex; mode=display">
D(p,q) = \sqrt{(p_1-q_1)^2+(p_2-q_2)^2+......+(p_n-q_n)^2}</script><p>where p and q are subjects to be compared with n characteristics.</p>
<h3 id="2-Parameter-K"><a href="#2-Parameter-K" class="headerlink" title="2. Parameter K"></a>2. Parameter K</h3><p>The appropriate choice of k <strong>has significant impact on</strong> the diagnostic performance of kNN algorithm.</p>
<p>  The key to choose an appropriate k value is to strike a balance <strong>between overfitting and underfitting.</strong></p>
<p>Some authors suggest to set <strong>k equal to the square root of the number of observations</strong> in the training dataset.</p>
<p>Let’s talk about the differences between <strong>approximate error(近似误差)</strong> and <strong>estimation error(估计误差)</strong>:</p>
<p>approximate error: a taining error <strong>for training set</strong></p>
<p>只能体现对<strong>训练数据</strong>的拟合表现。</p>
<p>estimation error: a testing error <strong>for testing set</strong></p>
<p>可体现对<strong>测试数据</strong>的拟合表现，也就是体现出泛化能力，因此对模型要求是估计误差越小越好。</p>
<p>In practical applications , we usually choose a pretty smaller parameter k which aims to get the best parameter k.</p>
<h2 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">knn_iris</span>():</span><br><span class="line">    <span class="comment">#1.获取数据集</span></span><br><span class="line">    iris = load_iris()</span><br><span class="line">    <span class="comment">#2.划分数据集</span></span><br><span class="line">    x_train ,x_test , y_train , y_test =  train_test_split(iris.data,iris.target,random_state=<span class="number">6</span>)</span><br><span class="line">    <span class="comment">#3.特征工程</span></span><br><span class="line">    transfer = StandardScaler()</span><br><span class="line">    x_train = transfer.fit_transform(x_train)</span><br><span class="line">    <span class="comment">#这里就是说测试集要用训练集的平均值和标准差</span></span><br><span class="line">    <span class="comment">#如果在之前统一标准化的话，训练集和测试集的数据成分就混了</span></span><br><span class="line">    <span class="comment">#如果test也用fit，则test用了自己的计算，就不再与train一致了</span></span><br><span class="line">    x_test = transfer.transform(x_test)</span><br><span class="line">    <span class="comment">#4.KNN</span></span><br><span class="line">    estimator = KNeighborsClassifier(n_neighbors=<span class="number">3</span>)</span><br><span class="line">    estimator.fit(x_train,y_train)</span><br><span class="line">    <span class="comment">#5.模型评估</span></span><br><span class="line">    <span class="comment">#法1.比对真实值和预测值</span></span><br><span class="line">    y_predict = estimator.predict(x_test)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"y_predict:\n"</span>,y_predict)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"直接对比真实值和预测值:\n"</span>,y_test == y_predict)</span><br><span class="line">    <span class="comment">#法2.计算准确率</span></span><br><span class="line">    score = estimator.score(x_test,y_test)</span><br><span class="line">    <span class="built_in">print</span>(score)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    knn_iris()</span><br></pre></td></tr></table></figure>
<h2 id="Evaluations"><a href="#Evaluations" class="headerlink" title="Evaluations"></a>Evaluations</h2><h3 id="Advantages"><a href="#Advantages" class="headerlink" title="Advantages"></a>Advantages</h3><p>①High accuracy(高精度)</p>
<p>②Insensitive to outliers(对异常值不敏感)</p>
<p>③No data entry assumes(无数据输入假定)</p>
<h3 id="Disadvantages"><a href="#Disadvantages" class="headerlink" title="Disadvantages"></a>Disadvantages</h3><p>High computational complexity and high spatial complexity (计算复杂度高、空间复杂度高)</p>
<h2 id="Differences-Between-Regression-and-Classification"><a href="#Differences-Between-Regression-and-Classification" class="headerlink" title="Differences Between Regression and Classification"></a>Differences Between Regression and Classification</h2><div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>Regression</th>
<th>Classification</th>
</tr>
</thead>
<tbody>
<tr>
<td>Output</td>
<td>Quantitative(定量)</td>
<td>Qualitative(定性)</td>
</tr>
</tbody>
</table>
</div>
<h2 id="KNN-Regression"><a href="#KNN-Regression" class="headerlink" title="KNN Regression"></a>KNN Regression</h2><script type="math/tex; mode=display">
\hat{y} = \frac{1}{K} \sum_{i=1}^{K}y_i</script><p><strong>Data normalization(数据归一化处理)</strong></p>
<p>使用零均值归一化：</p>
<script type="math/tex; mode=display">
z = \frac{x-\mu}{\sigma}</script><p><strong>Code</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsRegressor</span><br><span class="line"></span><br><span class="line">transformer = StandardScaler() <span class="comment">#数据预处理归一化</span></span><br><span class="line">x_train = np.array([</span><br><span class="line">    [<span class="number">158</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">170</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">183</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">191</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">155</span>, <span class="number">0</span>],</span><br><span class="line">    [<span class="number">163</span>, <span class="number">0</span>],</span><br><span class="line">    [<span class="number">180</span>, <span class="number">0</span>],</span><br><span class="line">    [<span class="number">158</span>, <span class="number">0</span>],</span><br><span class="line">    [<span class="number">170</span>, <span class="number">0</span>]</span><br><span class="line">])</span><br><span class="line">x_train_scaled = transformer.fit_transform(x_train)</span><br><span class="line">y_train = [<span class="number">64</span>, <span class="number">86</span>, <span class="number">84</span>, <span class="number">80</span>, <span class="number">49</span>, <span class="number">59</span>, <span class="number">67</span>, <span class="number">54</span>, <span class="number">67</span>]</span><br><span class="line"></span><br><span class="line">x_test = np.array([[<span class="number">168</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">180</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">160</span>, <span class="number">0</span>],</span><br><span class="line">    [<span class="number">169</span>, <span class="number">0</span>]])</span><br><span class="line">x_test_scaled = transformer.transform(x_test)</span><br><span class="line">y_test = [<span class="number">65</span>, <span class="number">96</span>, <span class="number">52</span>, <span class="number">67</span>]</span><br><span class="line"><span class="comment">##=============================上面是导入数据</span></span><br><span class="line">K = <span class="number">3</span></span><br><span class="line">clf = KNeighborsRegressor(n_neighbors=K)</span><br><span class="line">clf.fit(x_train_scaled,y_train)</span><br><span class="line">predictions = clf.predict(np.array(x_test_scaled))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'Predicted weights: %s'</span> % predictions)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'Actual weights: %s'</span> % y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'========回归评估:======='</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error </span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_absolute_error</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">'决定系数: %.4f'</span> % r2_score(y_test, predictions))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'均方差: %.4f'</span> % mean_squared_error(y_test, predictions))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'平均绝对误差: %.4f'</span> % mean_absolute_error(y_test, predictions))</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://nexuslbh.top">NexusLbh</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://nexuslbh.top/2022/08/26/KNN/">http://nexuslbh.top/2022/08/26/KNN/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://nexuslbh.top" target="_blank">Meta Field</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ML/">ML</a></div><div class="post_share"><div class="social-share" data-image="/img/tq.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/08/26/MYSQL-LeetcodePractice-DAY09&amp;10-%E8%A1%A5%E9%A2%98/" title="MYSQL-LeetcodePractice-DAY09&amp;10-补题"><img class="cover" src="https://w.wallhaven.cc/full/e7/wallhaven-e7qd98.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MYSQL-LeetcodePractice-DAY09&amp;10-补题</div></div></a></div><div class="next-post pull-right"><a href="/2022/08/25/MYSQL-LeetcodePractice-DAY07&amp;08-%E8%AE%A1%E7%AE%97%E5%87%BD%E6%95%B0/" title="MYSQL-LeetcodePractice-DAY07&amp;08-计算函数"><img class="cover" src="https://w.wallhaven.cc/full/gp/wallhaven-gp71rd.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MYSQL-LeetcodePractice-DAY07&amp;08-计算函数</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/08/31/GBDT/" title="GBDT"><img class="cover" src="/img/cloud.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="title">GBDT</div></div></a></div><div><a href="/2022/08/21/Decision-Tree/" title="Decision Tree"><img class="cover" src="https://w.wallhaven.cc/full/p9/wallhaven-p9kl83.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-21</div><div class="title">Decision Tree</div></div></a></div><div><a href="/2022/08/19/Genetic-Algorithm/" title="Genetic Algorithm"><img class="cover" src="https://w.wallhaven.cc/full/o5/wallhaven-o532dp.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-19</div><div class="title">Genetic Algorithm</div></div></a></div><div><a href="/2022/08/29/Neural-Network/" title="Neural Network"><img class="cover" src="/img/jp.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-29</div><div class="title">Neural Network</div></div></a></div><div><a href="/2022/08/24/Machine-Learning-Base/" title="Machine Learning Base"><img class="cover" src="/img/ms3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-24</div><div class="title">Machine Learning Base</div></div></a></div><div><a href="/2022/08/26/SVM/" title="SVM"><img class="cover" src="https://w.wallhaven.cc/full/1p/wallhaven-1p3729.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-26</div><div class="title">SVM</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">NexusLbh</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">63</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/NexusXDlbh"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/NexusXDlbh" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:3321861647@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction-to-K-Nearest-Neighbors-Classifier"><span class="toc-number">1.</span> <span class="toc-text">Introduction to K-Nearest Neighbors Classifier</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Distance"><span class="toc-number">1.1.</span> <span class="toc-text">1.Distance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Parameter-K"><span class="toc-number">1.2.</span> <span class="toc-text">2. Parameter K</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Implementation"><span class="toc-number">2.</span> <span class="toc-text">Implementation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Evaluations"><span class="toc-number">3.</span> <span class="toc-text">Evaluations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Advantages"><span class="toc-number">3.1.</span> <span class="toc-text">Advantages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Disadvantages"><span class="toc-number">3.2.</span> <span class="toc-text">Disadvantages</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Differences-Between-Regression-and-Classification"><span class="toc-number">4.</span> <span class="toc-text">Differences Between Regression and Classification</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KNN-Regression"><span class="toc-number">5.</span> <span class="toc-text">KNN Regression</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/03/27/%E9%93%BE%E8%A1%A8/" title="链表"><img src="https://w.wallhaven.cc/full/j3/wallhaven-j3g7yy.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="链表"/></a><div class="content"><a class="title" href="/2023/03/27/%E9%93%BE%E8%A1%A8/" title="链表">链表</a><time datetime="2023-03-28T10:17:46.114Z" title="更新于 2023-03-28 18:17:46">2023-03-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/28/%E6%A0%88/" title="栈"><img src="https://w.wallhaven.cc/full/2y/wallhaven-2y8x99.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="栈"/></a><div class="content"><a class="title" href="/2023/03/28/%E6%A0%88/" title="栈">栈</a><time datetime="2023-03-28T10:07:36.674Z" title="更新于 2023-03-28 18:07:36">2023-03-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/22/Crypto-Homework/" title="Crypto_Homework"><img src="/img/tree.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Crypto_Homework"/></a><div class="content"><a class="title" href="/2023/03/22/Crypto-Homework/" title="Crypto_Homework">Crypto_Homework</a><time datetime="2023-03-25T13:50:45.775Z" title="更新于 2023-03-25 21:50:45">2023-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/14/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E6%80%BB%E7%BB%93/" title="图像处理总结"><img src="/img/cloud.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="图像处理总结"/></a><div class="content"><a class="title" href="/2022/05/14/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E6%80%BB%E7%BB%93/" title="图像处理总结">图像处理总结</a><time datetime="2023-03-25T05:50:37.417Z" title="更新于 2023-03-25 13:50:37">2023-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/05/%E7%AB%AF%E5%8D%88%E5%B0%8F%E7%BB%93/" title="端午小结"><img src="/img/mout.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="端午小结"/></a><div class="content"><a class="title" href="/2022/06/05/%E7%AB%AF%E5%8D%88%E5%B0%8F%E7%BB%93/" title="端午小结">端午小结</a><time datetime="2023-03-25T05:49:11.052Z" title="更新于 2023-03-25 13:49:11">2023-03-25</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/tq.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By NexusLbh</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>